{"version":3,"sources":["file:///D:/cocos/MiniDiceGame/assets/scripts/core/HistoryManager.ts"],"names":["HistoryManager","constructor","storage","window","localStorage","key","maxRecords","histories","raw","getItem","JSON","parse","add","record","unshift","length","slice","save","setItem","stringify"],"mappings":";;;iBASaA,c;;;;;;;;;;;;;gCAAAA,c,GAAN,MAAMA,cAAN,CAAqB;AAO1BC,QAAAA,WAAW,CAACC,OAAgB,GAAGC,MAAM,CAACC,YAA3B,EAAyC;AAAA,eAN5CC,GAM4C,GANtC,mBAMsC;AAAA,eAL5CC,UAK4C,GAL/B,EAK+B;AAAA,eAJ5CJ,OAI4C;AAAA,eAFpDK,SAEoD,GAFxB,EAEwB;AAClD,eAAKL,OAAL,GAAeA,OAAf;AACA,gBAAMM,GAAG,GAAG,KAAKN,OAAL,CAAaO,OAAb,CAAqB,KAAKJ,GAA1B,CAAZ;;AACA,cAAIG,GAAJ,EAAS;AACP,gBAAI;AACF,mBAAKD,SAAL,GAAiBG,IAAI,CAACC,KAAL,CAAWH,GAAX,CAAjB;AACD,aAFD,CAEE,MAAM;AACN,mBAAKD,SAAL,GAAiB,EAAjB;AACD;AACF;AACF;;AAEDK,QAAAA,GAAG,CAACC,MAAD,EAAuB;AACxB,eAAKN,SAAL,CAAeO,OAAf,CAAuBD,MAAvB,EADwB,CACQ;;AAChC,cAAI,KAAKN,SAAL,CAAeQ,MAAf,GAAwB,KAAKT,UAAjC,EAA6C;AAC3C,iBAAKC,SAAL,GAAiB,KAAKA,SAAL,CAAeS,KAAf,CAAqB,CAArB,EAAwB,KAAKV,UAA7B,CAAjB,CAD2C,CACgB;AAC5D;;AACD,eAAKW,IAAL;AACD;;AAEDA,QAAAA,IAAI,GAAG;AACL,eAAKf,OAAL,CAAagB,OAAb,CAAqB,KAAKb,GAA1B,EAA+BK,IAAI,CAACS,SAAL,CAAe,KAAKZ,SAApB,CAA/B;AACD;;AA7ByB,O","sourcesContent":["export interface RoundHistory {\n  time: string;      // thời gian ván chơi\n  dice: number[];    // 3 mặt xúc xắc\n  total: number;     // tổng điểm\n  betType: string;   // TAI / XIU / TOTAL-x\n  result: string;    // WIN / LOSE\n  balance: number;   // điểm sau ván\n}\n\nexport class HistoryManager {\n  private key = 'mini-dice-history';\n  private maxRecords = 10;\n  private storage: Storage;\n\n  histories: RoundHistory[] = [];\n\n  constructor(storage: Storage = window.localStorage) {\n    this.storage = storage;\n    const raw = this.storage.getItem(this.key);\n    if (raw) {\n      try {\n        this.histories = JSON.parse(raw);\n      } catch {\n        this.histories = [];\n      }\n    }\n  }\n\n  add(record: RoundHistory) {\n    this.histories.unshift(record); // thêm vào đầu danh sách\n    if (this.histories.length > this.maxRecords) {\n      this.histories = this.histories.slice(0, this.maxRecords); // giữ lại 10 bản ghi\n    }\n    this.save();\n  }\n\n  save() {\n    this.storage.setItem(this.key, JSON.stringify(this.histories));\n  }\n}"]}