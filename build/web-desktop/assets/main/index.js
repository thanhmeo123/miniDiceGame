System.register("chunks:///_virtual/AudioManager.ts",["cc"],(function(){var c;return{setters:[function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"2d1c79XinZC3bhqLn3QcJ+f","AudioManager",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/BettingPanel.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"32c1fv1YgtNp6BM4merwgD+","BettingPanel",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/DiceService.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"86b0djSeXBMDZP8qEjrXNDC","DiceService",void 0);n("DiceService",function(){function n(n){this.rng=n}return n.prototype.roll=function(){return[this.rng.randInt(1,6),this.rng.randInt(1,6),this.rng.randInt(1,6)]},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/DiceView.ts",["cc"],(function(){var e;return{setters:[function(c){e=c.cclegacy}],execute:function(){e._RF.push({},"4484a0955JC5rC4ZhAr9y5N","DiceView",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RandomService.ts","./DiceService.ts","./ScoreManager.ts","./HistoryManager.ts","./RoundManager.ts"],(function(t){var e,n,i,r,a,o,l,u,s,c,h,p,b,g,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,l=t.Label,u=t.EditBox,s=t.Button,c=t.Component},function(t){h=t.RandomService},function(t){p=t.DiceService},function(t){b=t.ScoreManager},function(t){g=t.HistoryManager},function(t){f=t.RoundManager}],execute:function(){var B,d,y,L,m,I,v,w,T,G,z,M,S,N,R,x,A,D,H,O,U;a._RF.push({},"799c3LvFgNEh7ZPBNnElc/g","GameManager",void 0);var j=o.ccclass,E=o.property;t("GameManager",(B=j("GameManager"),d=E(l),y=E(l),L=E(l),m=E(l),I=E(u),v=E(u),w=E(s),T=E(s),G=E(s),B((S=e((M=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,i(e,"balanceLabel",S,r(e)),i(e,"resultLabel",N,r(e)),i(e,"diceLabel",R,r(e)),i(e,"historyLabel",x,r(e)),i(e,"amountInput",A,r(e)),i(e,"totalGuessInput",D,r(e)),i(e,"rollButton",H,r(e)),i(e,"taiButton",O,r(e)),i(e,"xiuButton",U,r(e)),e.round=void 0,e.score=void 0,e.history=void 0,e}n(e,t);var a=e.prototype;return a.onLoad=function(){var t=this,e=new h,n=new p(e);this.score=new b,this.history=new g,this.round=new f(n,this.score,this.history,(function(e){return t.onStateChange(e)})),this.updateBalance(),this.updateHistoryUI(),this.resetInputs()},a.onStateChange=function(t){"Rolling"===t&&(this.resultLabel.string="Rolling..."),"Settle"===t&&this.resetInputs()},a.updateBalance=function(){this.balanceLabel.string="Balance: "+this.score.balance},a.updateHistoryUI=function(){var t=this.history.histories,e=[].concat(t).reverse().map((function(t){return t.time+" | "+t.dice.join(",")+" | "+t.total+" | "+t.betType+" | "+t.result+" | "+t.balance}));this.historyLabel.string=e.join("\n")},a.resetInputs=function(){this.amountInput.string="",this.totalGuessInput.string="",this.rollButton&&(this.rollButton.interactable=!1),this.taiButton&&(this.taiButton.interactable=!0),this.xiuButton&&(this.xiuButton.interactable=!0),this.totalGuessInput&&(this.totalGuessInput.enabled=!0)},a.placeBetTai=function(){this.placeBet("TAI")},a.placeBetXiu=function(){this.placeBet("XIU")},a.placeBetTotal=function(){this.placeBet("TOTAL")},a.placeBet=function(t){var e,n=parseInt(this.amountInput.string||"0",10);if(n<=0||isNaN(n))return this.resultLabel.string="Nhập số điểm hợp lệ!",void(this.rollButton&&(this.rollButton.interactable=!1));if("TOTAL"===t&&(e=parseInt(this.totalGuessInput.string||"0",10),isNaN(e)||e<3||e>18))return this.resultLabel.string="Nhập tổng hợp lệ (3-18)!",void(this.rollButton&&(this.rollButton.interactable=!1));try{"TOTAL"===t?(this.round.placeBet({type:t,amount:n,totalGuess:e}),this.taiButton&&(this.taiButton.interactable=!1),this.xiuButton&&(this.xiuButton.interactable=!1)):(this.round.placeBet({type:t,amount:n}),this.totalGuessInput&&(this.totalGuessInput.enabled=!1)),this.resultLabel.string="Đặt "+n+" vào "+t+("TOTAL"===t?" (Tổng: "+e+")":""),this.rollButton&&(this.rollButton.interactable=!0)}catch(t){this.resultLabel.string="Lỗi: "+t.message,this.rollButton&&(this.rollButton.interactable=!1)}},a.onRoll=function(){try{if(!this.round.currentBet)return void(this.resultLabel.string="Bạn chưa đặt cược!");var t=this.round.roll(),e=t.dice,n=t.calc,i=n.total,r=n.delta,a="";a=i>=11&&i<=17?"TAI":i>=4&&i<=10?"XIU":"—",this.diceLabel.string="Dice: "+e.join("/")+" (Total: "+i+", "+a+")",this.resultLabel.string=n.win?"WIN (+"+r+")":"LOSE ("+r+")",this.updateBalance(),this.updateHistoryUI(),this.resetInputs()}catch(t){this.resultLabel.string="Lỗi: "+t.message}},e}(c)).prototype,"balanceLabel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(M.prototype,"resultLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(M.prototype,"diceLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(M.prototype,"historyLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(M.prototype,"amountInput",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(M.prototype,"totalGuessInput",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(M.prototype,"rollButton",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(M.prototype,"taiButton",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(M.prototype,"xiuButton",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=M))||z));a._RF.pop()}}}));

System.register("chunks:///_virtual/HistoryManager.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"213e925BkFJ7KXlDE+vkHwF","HistoryManager",void 0);t("HistoryManager",function(){function t(t){void 0===t&&(t=window.localStorage),this.key="mini-dice-history",this.maxRecords=10,this.storage=void 0,this.histories=[],this.storage=t;var i=this.storage.getItem(this.key);if(i)try{this.histories=JSON.parse(i)}catch(t){this.histories=[]}}var i=t.prototype;return i.add=function(t){this.histories.unshift(t),this.histories.length>this.maxRecords&&(this.histories=this.histories.slice(0,this.maxRecords)),this.save()},i.save=function(){this.storage.setItem(this.key,JSON.stringify(this.histories))},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/HistoryView.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"d2d653qHi1PhbNIyAg8uGJH","HistoryView",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./DiceService.ts","./HistoryManager.ts","./RandomService.ts","./ResultCalculator.ts","./RoundManager.ts","./ScoreManager.ts","./models.ts","./AudioManager.ts","./BettingPanel.ts","./DiceView.ts","./GameManager.ts","./HistoryView.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/models.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"43810rY185EnIllJP8uwCVu","models",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/RandomService.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"103e7+lX6lLFq0uGPns2rm0","RandomService",void 0);n("RandomService",function(){function n(n){void 0===n&&(n=Math.random),this.randFn=n}return n.prototype.randInt=function(n,t){return Math.floor(this.randFn()*(t-n+1))+n},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/ResultCalculator.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){t("calculateResult",(function(t,e){var u=t.reduce((function(t,e){return t+e}),0),c=!1,l=0,n=u>=11&&u<=17,r=u>=4&&u<=10;"TAI"===e.type?(c=n,l=1):"XIU"===e.type?(c=r,l=1):"TOTAL"===e.type&&(c=e.totalGuess===u,l=5);var a=c?e.amount*l:-e.amount;return{total:u,win:c,multiplier:l,delta:a,betType:e.type}})),e._RF.push({},"65016/ZbGlJXJmc2ZPPxj7q","ResultCalculator",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/RoundManager.ts",["cc","./ResultCalculator.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.calculateResult}],execute:function(){e._RF.push({},"68ecepqR5NHOZdkfmYH7k8v","RoundManager",void 0);t("RoundManager",function(){function t(t,e,n,a){this.state="Idle",this.currentBet=null,this.lastDice=null,this.diceService=t,this.scoreManager=e,this.history=n,this.onStateChange=a}var e=t.prototype;return e.setState=function(t){this.state=t,this.onStateChange&&this.onStateChange(t)},e.clearBet=function(){this.currentBet=null,this.setState("Idle")},e.startBetting=function(){this.clearBet(),this.setState("Betting")},e.placeBet=function(t){if(t.amount<=0)throw new Error("Bet must > 0");if(t.amount>this.scoreManager.balance)throw new Error("Not enough balance");this.currentBet=t,this.setState("Betting")},e.roll=function(){if(!this.currentBet)throw new Error("No bet placed!");this.setState("Rolling");var t=this.diceService.roll();this.lastDice=t;var e=n(t,this.currentBet);this.setState("Result"),this.scoreManager.change(e.delta);(new Date).toISOString(),e.total,this.currentBet,e.win,this.scoreManager.balance;return this.history.add({time:(new Date).toLocaleTimeString(),dice:t,total:e.total,betType:this.currentBet.type,result:e.win?"WIN":"LOSE",balance:this.scoreManager.balance}),this.setState("Settle"),this.currentBet=null,this.setState("Idle"),{dice:t,calc:e}},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/ScoreManager.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"4aba9USSxlI/YTUTU1g2mF4","ScoreManager",void 0);e("ScoreManager",function(){function e(e,t){void 0===e&&(e=window.localStorage),void 0===t&&(t="mini-dice-balance"),this.key=void 0,this.storage=void 0,this.balance=void 0,this.storage=e,this.key=t;var a=this.storage.getItem(this.key),i=null!==a?Number(a):NaN;isNaN(i)||i<0?this.balance=1e3:this.balance=Math.floor(i),this.save()}var t=e.prototype;return t.change=function(e){this.balance+=e,this.balance<0&&(this.balance=0),this.save()},t.save=function(){this.storage.setItem(this.key,String(this.balance))},e}());t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL0RpY2VTZXJ2aWNlLnRzIiwiLi4vZmlsZTovRDovY29jb3MvTWluaURpY2VHYW1lL2Fzc2V0cy9zY3JpcHRzL3VpL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy91aS9HYW1lTWFuYWdlci50cyIsIi4uL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL0hpc3RvcnlNYW5hZ2VyLnRzIiwiLi4vZmlsZTovRDovY29jb3MvTWluaURpY2VHYW1lL2Fzc2V0cy9zY3JpcHRzL2NvcmUvZmlsZTovRDovY29jb3MvTWluaURpY2VHYW1lL2Fzc2V0cy9zY3JpcHRzL2NvcmUvUmFuZG9tU2VydmljZS50cyIsIi4uL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL1Jlc3VsdENhbGN1bGF0b3IudHMiLCIuLi9maWxlOi9EOi9jb2Nvcy9NaW5pRGljZUdhbWUvYXNzZXRzL3NjcmlwdHMvY29yZS9maWxlOi9EOi9jb2Nvcy9NaW5pRGljZUdhbWUvYXNzZXRzL3NjcmlwdHMvY29yZS9Sb3VuZE1hbmFnZXIudHMiLCIuLi9maWxlOi9EOi9jb2Nvcy9NaW5pRGljZUdhbWUvYXNzZXRzL3NjcmlwdHMvY29yZS9maWxlOi9EOi9jb2Nvcy9NaW5pRGljZUdhbWUvYXNzZXRzL3NjcmlwdHMvY29yZS9TY29yZU1hbmFnZXIudHMiXSwibmFtZXMiOlsiRGljZVNlcnZpY2UiLCJybmciLCJ0aGlzIiwicHJvdG90eXBlIiwicm9sbCIsInJhbmRJbnQiLCJfUkYiLCJwb3AiLCJjY2NsYXNzIiwiX2RlY29yYXRvciIsInByb3BlcnR5IiwiX2RlYyIsIl9kZWMyIiwiTGFiZWwiLCJfZGVjMyIsIl9kZWM0IiwiX2RlYzUiLCJfZGVjNiIsIkVkaXRCb3giLCJfZGVjNyIsIl9kZWM4IiwiQnV0dG9uIiwiX2RlYzkiLCJfZGVjMTAiLCJfZGVzY3JpcHRvciIsIl9hcHBseURlY29yYXRlZERlc2NyaXB0b3IiLCJfY2xhc3MyIiwiX0NvbXBvbmVudCIsIkdhbWVNYW5hZ2VyIiwiX3RoaXMiLCJfbGVuIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiYXJncyIsIkFycmF5IiwiX2tleSIsImNhbGwiLCJhcHBseSIsImNvbmNhdCIsIl9pbml0aWFsaXplckRlZmluZVByb3BlcnR5IiwiX2Fzc2VydFRoaXNJbml0aWFsaXplZCIsIl9kZXNjcmlwdG9yMiIsIl9kZXNjcmlwdG9yMyIsIl9kZXNjcmlwdG9yNCIsIl9kZXNjcmlwdG9yNSIsIl9kZXNjcmlwdG9yNiIsIl9kZXNjcmlwdG9yNyIsIl9kZXNjcmlwdG9yOCIsIl9kZXNjcmlwdG9yOSIsInJvdW5kIiwic2NvcmUiLCJoaXN0b3J5IiwiX2luaGVyaXRzTG9vc2UiLCJfcHJvdG8iLCJvbkxvYWQiLCJfdGhpczIiLCJSYW5kb21TZXJ2aWNlIiwiZGljZVNlcnZpY2UiLCJTY29yZU1hbmFnZXIiLCJIaXN0b3J5TWFuYWdlciIsIlJvdW5kTWFuYWdlciIsInMiLCJvblN0YXRlQ2hhbmdlIiwidXBkYXRlQmFsYW5jZSIsInVwZGF0ZUhpc3RvcnlVSSIsInJlc2V0SW5wdXRzIiwicmVzdWx0TGFiZWwiLCJzdHJpbmciLCJiYWxhbmNlTGFiZWwiLCJiYWxhbmNlIiwibGlzdCIsImhpc3RvcmllcyIsImxpbmVzIiwicmV2ZXJzZSIsIm1hcCIsImgiLCJ0aW1lIiwiZGljZSIsImpvaW4iLCJ0b3RhbCIsImJldFR5cGUiLCJyZXN1bHQiLCJoaXN0b3J5TGFiZWwiLCJhbW91bnRJbnB1dCIsInRvdGFsR3Vlc3NJbnB1dCIsInJvbGxCdXR0b24iLCJpbnRlcmFjdGFibGUiLCJ0YWlCdXR0b24iLCJ4aXVCdXR0b24iLCJlbmFibGVkIiwicGxhY2VCZXRUYWkiLCJwbGFjZUJldCIsInBsYWNlQmV0WGl1IiwicGxhY2VCZXRUb3RhbCIsInR5cGUiLCJndWVzcyIsImFtdCIsInBhcnNlSW50IiwiaXNOYU4iLCJhbW91bnQiLCJ0b3RhbEd1ZXNzIiwiZSIsIm1lc3NhZ2UiLCJvblJvbGwiLCJjdXJyZW50QmV0IiwiX3RoaXMkcm91bmQkcm9sbCIsImNhbGMiLCJkZWx0YSIsInRhaVhpdSIsImRpY2VMYWJlbCIsIndpbiIsImVyciIsIkNvbXBvbmVudCIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImluaXRpYWxpemVyIiwiX2NsYXNzIiwic3RvcmFnZSIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsImtleSIsIm1heFJlY29yZHMiLCJyYXciLCJnZXRJdGVtIiwiSlNPTiIsInBhcnNlIiwiX3VudXNlZCIsImFkZCIsInJlY29yZCIsInVuc2hpZnQiLCJzbGljZSIsInNhdmUiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwicmFuZEZuIiwiTWF0aCIsInJhbmRvbSIsIm1pbiIsIm1heCIsImZsb29yIiwiYmV0IiwicmVkdWNlIiwidiIsIm11bHRpcGxpZXIiLCJpc1RhaSIsImlzWGl1Iiwic2NvcmVNYW5hZ2VyIiwic3RhdGUiLCJsYXN0RGljZSIsInNldFN0YXRlIiwiY2xlYXJCZXQiLCJzdGFydEJldHRpbmciLCJFcnJvciIsImNhbGN1bGF0ZVJlc3VsdCIsImNoYW5nZSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInRvTG9jYWxlVGltZVN0cmluZyIsInZhbCIsIk51bWJlciIsIk5hTiIsIlN0cmluZyJdLCJtYXBwaW5ncyI6Ijs7OztxT0FHRSxTQUFBQSxFQUFvQkMsR0FBb0JDLEtBQXBCRCxJQUFBQSxFQVFuQixPQVJ5Q0QsRUFBQUcsVUFFMUNDLEtBQUEsV0FDRSxNQUFPLENBQ0xGLEtBQUtELElBQUlJ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SUFBQUEsRUFBTSxxQkFBbUJ2SCxLQUp6RXVILFdBQUd2SCxLQUNIb0gsZUFBT3BILEtBQ2ZtRSxlQUdFbkUsS0FBS29ILFFBQVVBLEVBQ2ZwSCxLQUFLdUgsSUFBTUEsRUFFWCxJQUFNRSxFQUFNekgsS0FBS29ILFFBQVFNLFFBQVExSCxLQUFLdUgsS0FHbENzQyxFQUFjLE9BQVJwQyxFQUFlcUMsT0FBT3JDLEdBQU9zQyxJQUduQy9ELE1BQU02RCxJQUFRQSxFQUFNLEVBQ3RCN0osS0FBS21FLFFBQVUsSUFFZm5FLEtBQUttRSxRQUFVbUUsS0FBS0ksTUFBTW1CLEdBRzVCN0osS0FBS2tJLE9BQ04sSUFBQS9FLEVBQUFLLEVBQUF2RCxVQVVBLE9BVkFrRCxFQUVEc0csT0FBQSxTQUFPaEQsR0FDTHpHLEtBQUttRSxTQUFXc0MsRUFDWnpHLEtBQUttRSxRQUFVLElBQUduRSxLQUFLbUUsUUFBVSxHQUNyQ25FLEtBQUtrSSxRQUNOL0UsRUFFRCtFLEtBQUEsV0FDRWxJLEtBQUtvSCxRQUFRZSxRQUFRbkksS0FBS3VILElBQUt5QyxPQUFPaEssS0FBS21FLFdBQzVDWCxRQUNGcEQsSUFBQUMiLCJmaWxlIjoiYWxsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmFuZG9tU2VydmljZSB9IGZyb20gJy4vUmFuZG9tU2VydmljZSc7XG5cbmV4cG9ydCBjbGFzcyBEaWNlU2VydmljZSB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcm5nOiBSYW5kb21TZXJ2aWNlKSB7fVxuXG4gIHJvbGwoKTogW251bWJlciwgbnVtYmVyLCBudW1iZXJdIHtcbiAgICByZXR1cm4gW1xuICAgICAgdGhpcy5ybmcucmFuZEludCgxLCA2KSxcbiAgICAgIHRoaXMucm5nLnJhbmRJbnQoMSwgNiksXG4gICAgICB0aGlzLnJuZy5yYW5kSW50KDEsIDYpLFxuICAgIF07XG4gIH1cbn1cbiIsImltcG9ydCB7IF9kZWNvcmF0b3IsIENvbXBvbmVudCwgTGFiZWwsIEJ1dHRvbiwgRWRpdEJveCB9IGZyb20gJ2NjJztcbmltcG9ydCB7IFJhbmRvbVNlcnZpY2UgfSBmcm9tICcuLi9jb3JlL1JhbmRvbVNlcnZpY2UnO1xuaW1wb3J0IHsgRGljZVNlcnZpY2UgfSBmcm9tICcuLi9jb3JlL0RpY2VTZXJ2aWNlJztcbmltcG9ydCB7IFNjb3JlTWFuYWdlciB9IGZyb20gJy4uL2NvcmUvU2NvcmVNYW5hZ2VyJztcbmltcG9ydCB7IEhpc3RvcnlNYW5hZ2VyIH0gZnJvbSAnLi4vY29yZS9IaXN0b3J5TWFuYWdlcic7XG5pbXBvcnQgeyBSb3VuZE1hbmFnZXIgfSBmcm9tICcuLi9jb3JlL1JvdW5kTWFuYWdlcic7XG5cbmNvbnN0IHsgY2NjbGFzcywgcHJvcGVydHkgfSA9IF9kZWNvcmF0b3I7XG5cbkBjY2NsYXNzKCdHYW1lTWFuYWdlcicpXG5leHBvcnQgY2xhc3MgR2FtZU1hbmFnZXIgZXh0ZW5kcyBDb21wb25lbnQge1xuICBAcHJvcGVydHkoTGFiZWwpIGJhbGFuY2VMYWJlbDogTGFiZWwgPSBudWxsITtcbiAgQHByb3BlcnR5KExhYmVsKSByZXN1bHRMYWJlbDogTGFiZWwgPSBudWxsITtcbiAgQHByb3BlcnR5KExhYmVsKSBkaWNlTGFiZWw6IExhYmVsID0gbnVsbCE7XG4gIEBwcm9wZXJ0eShMYWJlbCkgaGlzdG9yeUxhYmVsOiBMYWJlbCA9IG51bGwhO1xuICBAcHJvcGVydHkoRWRpdEJveCkgYW1vdW50SW5wdXQ6IEVkaXRCb3ggPSBudWxsITtcbiAgQHByb3BlcnR5KEVkaXRCb3gpIHRvdGFsR3Vlc3NJbnB1dDogRWRpdEJveCA9IG51bGwhO1xuICBAcHJvcGVydHkoQnV0dG9uKSByb2xsQnV0dG9uOiBCdXR0b24gPSBudWxsITtcbiAgQHByb3BlcnR5KEJ1dHRvbikgdGFpQnV0dG9uOiBCdXR0b24gPSBudWxsITtcbiAgQHByb3BlcnR5KEJ1dHRvbikgeGl1QnV0dG9uOiBCdXR0b24gPSBudWxsITtcblxuICBwcml2YXRlIHJvdW5kITogUm91bmRNYW5hZ2VyO1xuICBwcml2YXRlIHNjb3JlITogU2NvcmVNYW5hZ2VyO1xuICBwcml2YXRlIGhpc3RvcnkhOiBIaXN0b3J5TWFuYWdlcjtcblxuICBvbkxvYWQoKSB7XG4gICAgY29uc3Qgcm5nID0gbmV3IFJhbmRvbVNlcnZpY2UoKTtcbiAgICBjb25zdCBkaWNlU2VydmljZSA9IG5ldyBEaWNlU2VydmljZShybmcpO1xuICAgIHRoaXMuc2NvcmUgPSBuZXcgU2NvcmVNYW5hZ2VyKCk7XG4gICAgdGhpcy5oaXN0b3J5ID0gbmV3IEhpc3RvcnlNYW5hZ2VyKCk7XG4gICAgdGhpcy5yb3VuZCA9IG5ldyBSb3VuZE1hbmFnZXIoXG4gICAgICBkaWNlU2VydmljZSxcbiAgICAgIHRoaXMuc2NvcmUsXG4gICAgICB0aGlzLmhpc3RvcnksXG4gICAgICAoczogc3RyaW5nKSA9PiB0aGlzLm9uU3RhdGVDaGFuZ2UocylcbiAgICApO1xuXG4gICAgdGhpcy51cGRhdGVCYWxhbmNlKCk7XG4gICAgdGhpcy51cGRhdGVIaXN0b3J5VUkoKTtcbiAgICB0aGlzLnJlc2V0SW5wdXRzKCk7XG4gIH1cblxuICBvblN0YXRlQ2hhbmdlKHM6IHN0cmluZykge1xuICAgIGlmIChzID09PSAnUm9sbGluZycpIHtcbiAgICAgIHRoaXMucmVzdWx0TGFiZWwuc3RyaW5nID0gXCJSb2xsaW5nLi4uXCI7XG4gICAgfVxuICAgIGlmIChzID09PSAnU2V0dGxlJykge1xuICAgICAgdGhpcy5yZXNldElucHV0cygpO1xuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZUJhbGFuY2UoKSB7XG4gICAgdGhpcy5iYWxhbmNlTGFiZWwuc3RyaW5nID0gYEJhbGFuY2U6ICR7dGhpcy5zY29yZS5iYWxhbmNlfWA7XG4gIH1cblxuICB1cGRhdGVIaXN0b3J5VUkoKSB7XG4gICAgY29uc3QgbGlzdCA9IHRoaXMuaGlzdG9yeS5oaXN0b3JpZXM7XG4gICAgY29uc3QgbGluZXMgPSBbLi4ubGlzdF0ucmV2ZXJzZSgpLm1hcChoID0+IHtcbiAgICAgIHJldHVybiBgJHtoLnRpbWV9IHwgJHtoLmRpY2Uuam9pbignLCcpfSB8ICR7aC50b3RhbH0gfCAke2guYmV0VHlwZX0gfCAke2gucmVzdWx0fSB8ICR7aC5iYWxhbmNlfWA7XG4gICAgfSk7XG4gICAgdGhpcy5oaXN0b3J5TGFiZWwuc3RyaW5nID0gbGluZXMuam9pbignXFxuJyk7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBSZXNldCBJbnB1dHMgc2F1IG3hu5dpIHbDsm5nXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIHJlc2V0SW5wdXRzKCkge1xuICAgIHRoaXMuYW1vdW50SW5wdXQuc3RyaW5nID0gJyc7XG4gICAgdGhpcy50b3RhbEd1ZXNzSW5wdXQuc3RyaW5nID0gJyc7XG4gICAgaWYgKHRoaXMucm9sbEJ1dHRvbikgdGhpcy5yb2xsQnV0dG9uLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnRhaUJ1dHRvbikgdGhpcy50YWlCdXR0b24uaW50ZXJhY3RhYmxlID0gdHJ1ZTtcbiAgICBpZiAodGhpcy54aXVCdXR0b24pIHRoaXMueGl1QnV0dG9uLmludGVyYWN0YWJsZSA9IHRydWU7XG4gICAgaWYgKHRoaXMudG90YWxHdWVzc0lucHV0KSB0aGlzLnRvdGFsR3Vlc3NJbnB1dC5lbmFibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIMSQ4bq3dCBjxrDhu6NjXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIHBsYWNlQmV0VGFpKCkge1xuICAgIHRoaXMucGxhY2VCZXQoJ1RBSScpO1xuICB9XG5cbiAgcGxhY2VCZXRYaXUoKSB7XG4gICAgdGhpcy5wbGFjZUJldCgnWElVJyk7XG4gIH1cblxuICBwbGFjZUJldFRvdGFsKCkge1xuICAgIHRoaXMucGxhY2VCZXQoJ1RPVEFMJyk7XG4gIH1cblxuICBwbGFjZUJldCh0eXBlOiAnVEFJJyB8ICdYSVUnIHwgJ1RPVEFMJykge1xuICAgIGNvbnN0IGFtdCA9IHBhcnNlSW50KHRoaXMuYW1vdW50SW5wdXQuc3RyaW5nIHx8ICcwJywgMTApO1xuICAgIGlmIChhbXQgPD0gMCB8fCBpc05hTihhbXQpKSB7XG4gICAgICB0aGlzLnJlc3VsdExhYmVsLnN0cmluZyA9ICdOaOG6rXAgc+G7kSDEkWnhu4NtIGjhu6NwIGzhu4chJztcbiAgICAgIGlmICh0aGlzLnJvbGxCdXR0b24pIHRoaXMucm9sbEJ1dHRvbi5pbnRlcmFjdGFibGUgPSBmYWxzZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgZ3Vlc3M6IG51bWJlciB8IHVuZGVmaW5lZDtcblxuICAgIGlmICh0eXBlID09PSAnVE9UQUwnKSB7XG4gICAgICBndWVzcyA9IHBhcnNlSW50KHRoaXMudG90YWxHdWVzc0lucHV0LnN0cmluZyB8fCAnMCcsIDEwKTtcbiAgICAgIGlmIChpc05hTihndWVzcykgfHwgZ3Vlc3MgPCAzIHx8IGd1ZXNzID4gMTgpIHtcbiAgICAgICAgdGhpcy5yZXN1bHRMYWJlbC5zdHJpbmcgPSAnTmjhuq1wIHThu5VuZyBo4bujcCBs4buHICgzLTE4KSEnO1xuICAgICAgICBpZiAodGhpcy5yb2xsQnV0dG9uKSB0aGlzLnJvbGxCdXR0b24uaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgaWYgKHR5cGUgPT09ICdUT1RBTCcpIHtcbiAgICAgICAgdGhpcy5yb3VuZC5wbGFjZUJldCh7IHR5cGUsIGFtb3VudDogYW10LCB0b3RhbEd1ZXNzOiBndWVzcyB9KTtcbiAgICAgICAgLy8gZGlzYWJsZSAyIG7DunQgVMOgaS9Y4buJdVxuICAgICAgICBpZiAodGhpcy50YWlCdXR0b24pIHRoaXMudGFpQnV0dG9uLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy54aXVCdXR0b24pIHRoaXMueGl1QnV0dG9uLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5yb3VuZC5wbGFjZUJldCh7IHR5cGUsIGFtb3VudDogYW10IH0pO1xuICAgICAgICAvLyBkaXNhYmxlIMO0IG5o4bqtcCB04buVbmdcbiAgICAgICAgaWYgKHRoaXMudG90YWxHdWVzc0lucHV0KSB0aGlzLnRvdGFsR3Vlc3NJbnB1dC5lbmFibGVkID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucmVzdWx0TGFiZWwuc3RyaW5nID0gYMSQ4bq3dCAke2FtdH0gdsOgbyAke3R5cGV9JHt0eXBlID09PSAnVE9UQUwnID8gYCAoVOG7lW5nOiAke2d1ZXNzfSlgIDogJyd9YDtcbiAgICAgIGlmICh0aGlzLnJvbGxCdXR0b24pIHRoaXMucm9sbEJ1dHRvbi5pbnRlcmFjdGFibGUgPSB0cnVlO1xuXG4gICAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgICB0aGlzLnJlc3VsdExhYmVsLnN0cmluZyA9IGBM4buXaTogJHtlLm1lc3NhZ2V9YDtcbiAgICAgIGlmICh0aGlzLnJvbGxCdXR0b24pIHRoaXMucm9sbEJ1dHRvbi5pbnRlcmFjdGFibGUgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBSb2xsXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIG9uUm9sbCgpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKCF0aGlzLnJvdW5kLmN1cnJlbnRCZXQpIHtcbiAgICAgICAgdGhpcy5yZXN1bHRMYWJlbC5zdHJpbmcgPSAnQuG6oW4gY2jGsGEgxJHhurd0IGPGsOG7o2MhJztcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB7IGRpY2UsIGNhbGMgfSA9IHRoaXMucm91bmQucm9sbCgpO1xuXG4gICAgICBjb25zdCB0b3RhbCA9IGNhbGMudG90YWw7XG4gICAgICBjb25zdCBkZWx0YSA9IGNhbGMuZGVsdGE7XG5cbiAgICAgIC8vIFTDoGkvWOG7iXUgdGV4dCB04burIHThu5VuZ1xuICAgICAgbGV0IHRhaVhpdSA9ICcnO1xuICAgICAgaWYgKHRvdGFsID49IDExICYmIHRvdGFsIDw9IDE3KSB0YWlYaXUgPSAnVEFJJztcbiAgICAgIGVsc2UgaWYgKHRvdGFsID49IDQgJiYgdG90YWwgPD0gMTApIHRhaVhpdSA9ICdYSVUnO1xuICAgICAgZWxzZSB0YWlYaXUgPSAn4oCUJztcblxuICAgICAgLy8gSGnhu4NuIHRo4buLIHjDumMgeOG6r2NcbiAgICAgIHRoaXMuZGljZUxhYmVsLnN0cmluZyA9IGBEaWNlOiAke2RpY2Uuam9pbignLycpfSAoVG90YWw6ICR7dG90YWx9LCAke3RhaVhpdX0pYDtcblxuICAgICAgLy8gSGnhu4NuIHRo4buLIGvhur90IHF14bqjXG4gICAgICB0aGlzLnJlc3VsdExhYmVsLnN0cmluZyA9IGNhbGMud2luXG4gICAgICAgID8gYFdJTiAoKyR7ZGVsdGF9KWBcbiAgICAgICAgOiBgTE9TRSAoJHtkZWx0YX0pYDtcblxuICAgICAgdGhpcy51cGRhdGVCYWxhbmNlKCk7XG4gICAgICB0aGlzLnVwZGF0ZUhpc3RvcnlVSSgpO1xuXG4gICAgICAvLyBTYXUgUm9sbCB4b25nLCByZXNldCDEkeG7gyBjaHXhuqluIGLhu4sgdsOybmcgbeG7m2lcbiAgICAgIHRoaXMucmVzZXRJbnB1dHMoKTtcblxuICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgICB0aGlzLnJlc3VsdExhYmVsLnN0cmluZyA9IGBM4buXaTogJHtlcnIubWVzc2FnZX1gO1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGludGVyZmFjZSBSb3VuZEhpc3Rvcnkge1xuICB0aW1lOiBzdHJpbmc7ICAgICAgLy8gdGjhu51pIGdpYW4gdsOhbiBjaMahaVxuICBkaWNlOiBudW1iZXJbXTsgICAgLy8gMyBt4bq3dCB4w7pjIHjhuq9jXG4gIHRvdGFsOiBudW1iZXI7ICAgICAvLyB04buVbmcgxJFp4buDbVxuICBiZXRUeXBlOiBzdHJpbmc7ICAgLy8gVEFJIC8gWElVIC8gVE9UQUwteFxuICByZXN1bHQ6IHN0cmluZzsgICAgLy8gV0lOIC8gTE9TRVxuICBiYWxhbmNlOiBudW1iZXI7ICAgLy8gxJFp4buDbSBzYXUgdsOhblxufVxuXG5leHBvcnQgY2xhc3MgSGlzdG9yeU1hbmFnZXIge1xuICBwcml2YXRlIGtleSA9ICdtaW5pLWRpY2UtaGlzdG9yeSc7XG4gIHByaXZhdGUgbWF4UmVjb3JkcyA9IDEwO1xuICBwcml2YXRlIHN0b3JhZ2U6IFN0b3JhZ2U7XG5cbiAgaGlzdG9yaWVzOiBSb3VuZEhpc3RvcnlbXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKHN0b3JhZ2U6IFN0b3JhZ2UgPSB3aW5kb3cubG9jYWxTdG9yYWdlKSB7XG4gICAgdGhpcy5zdG9yYWdlID0gc3RvcmFnZTtcbiAgICBjb25zdCByYXcgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmtleSk7XG4gICAgaWYgKHJhdykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5oaXN0b3JpZXMgPSBKU09OLnBhcnNlKHJhdyk7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgdGhpcy5oaXN0b3JpZXMgPSBbXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhZGQocmVjb3JkOiBSb3VuZEhpc3RvcnkpIHtcbiAgICB0aGlzLmhpc3Rvcmllcy51bnNoaWZ0KHJlY29yZCk7IC8vIHRow6ptIHbDoG8gxJHhuqd1IGRhbmggc8OhY2hcbiAgICBpZiAodGhpcy5oaXN0b3JpZXMubGVuZ3RoID4gdGhpcy5tYXhSZWNvcmRzKSB7XG4gICAgICB0aGlzLmhpc3RvcmllcyA9IHRoaXMuaGlzdG9yaWVzLnNsaWNlKDAsIHRoaXMubWF4UmVjb3Jkcyk7IC8vIGdp4buvIGzhuqFpIDEwIGLhuqNuIGdoaVxuICAgIH1cbiAgICB0aGlzLnNhdmUoKTtcbiAgfVxuXG4gIHNhdmUoKSB7XG4gICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0odGhpcy5rZXksIEpTT04uc3RyaW5naWZ5KHRoaXMuaGlzdG9yaWVzKSk7XG4gIH1cbn0iLCJleHBvcnQgdHlwZSBSYW5kRm4gPSAoKSA9PiBudW1iZXI7XG5cbmV4cG9ydCBjbGFzcyBSYW5kb21TZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByYW5kRm46IFJhbmRGbiA9IE1hdGgucmFuZG9tKSB7fVxuXG4gIHJhbmRJbnQobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5mbG9vcih0aGlzLnJhbmRGbigpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcbiAgfVxufVxuIiwiaW1wb3J0IHsgQmV0IH0gZnJvbSAnLi9tb2RlbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIENhbGNSZXN1bHQge1xuICB0b3RhbDogbnVtYmVyO1xuICB3aW46IGJvb2xlYW47XG4gIG11bHRpcGxpZXI6IG51bWJlcjtcbiAgZGVsdGE6IG51bWJlcjtcbiAgYmV0VHlwZTogc3RyaW5nOyBcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZVJlc3VsdChkaWNlOiBudW1iZXJbXSwgYmV0OiBCZXQpOiBDYWxjUmVzdWx0IHtcbiAgY29uc3QgdG90YWwgPSBkaWNlLnJlZHVjZSgocywgdikgPT4gcyArIHYsIDApO1xuICBsZXQgd2luID0gZmFsc2U7XG4gIGxldCBtdWx0aXBsaWVyID0gMDtcblxuICBjb25zdCBpc1RhaSA9IHRvdGFsID49IDExICYmIHRvdGFsIDw9IDE3O1xuICBjb25zdCBpc1hpdSA9IHRvdGFsID49IDQgJiYgdG90YWwgPD0gMTA7XG5cbiAgaWYgKGJldC50eXBlID09PSAnVEFJJykge1xuICAgIHdpbiA9IGlzVGFpO1xuICAgIG11bHRpcGxpZXIgPSAxO1xuICB9IGVsc2UgaWYgKGJldC50eXBlID09PSAnWElVJykge1xuICAgIHdpbiA9IGlzWGl1O1xuICAgIG11bHRpcGxpZXIgPSAxO1xuICB9IGVsc2UgaWYgKGJldC50eXBlID09PSAnVE9UQUwnKSB7XG4gICAgd2luID0gYmV0LnRvdGFsR3Vlc3MgPT09IHRvdGFsO1xuICAgIG11bHRpcGxpZXIgPSA1O1xuICB9XG5cbiAgY29uc3QgZGVsdGEgPSB3aW4gPyBiZXQuYW1vdW50ICogbXVsdGlwbGllciA6IC1iZXQuYW1vdW50O1xuICByZXR1cm4geyB0b3RhbCwgd2luLCBtdWx0aXBsaWVyLCBkZWx0YSwgYmV0VHlwZTogYmV0LnR5cGUgfTsgLy8gdGjDqm0g4bufIMSRw6J5XG59XG4iLCIvLyBhc3NldHMvc2NyaXB0cy9jb3JlL1JvdW5kTWFuYWdlci50c1xuaW1wb3J0IHsgRGljZVNlcnZpY2UgfSBmcm9tICcuL0RpY2VTZXJ2aWNlJztcbmltcG9ydCB7IFNjb3JlTWFuYWdlciB9IGZyb20gJy4vU2NvcmVNYW5hZ2VyJztcbmltcG9ydCB7IEhpc3RvcnlNYW5hZ2VyIH0gZnJvbSAnLi9IaXN0b3J5TWFuYWdlcic7XG5pbXBvcnQgeyBjYWxjdWxhdGVSZXN1bHQgfSBmcm9tICcuL1Jlc3VsdENhbGN1bGF0b3InO1xuaW1wb3J0IHsgQmV0LCBSb3VuZFJlY29yZCB9IGZyb20gJy4vbW9kZWxzJztcblxuZXhwb3J0IHR5cGUgR2FtZVN0YXRlID0gJ0lkbGUnIHwgJ0JldHRpbmcnIHwgJ1JvbGxpbmcnIHwgJ1Jlc3VsdCcgfCAnU2V0dGxlJztcblxuZXhwb3J0IGNsYXNzIFJvdW5kTWFuYWdlciB7XG4gIHN0YXRlOiBHYW1lU3RhdGUgPSAnSWRsZSc7XG4gIGN1cnJlbnRCZXQ6IEJldCB8IG51bGwgPSBudWxsO1xuICBsYXN0RGljZTogW251bWJlciwgbnVtYmVyLCBudW1iZXJdIHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBkaWNlU2VydmljZTogRGljZVNlcnZpY2UsXG4gICAgcHJpdmF0ZSBzY29yZU1hbmFnZXI6IFNjb3JlTWFuYWdlcixcbiAgICBwcml2YXRlIGhpc3Rvcnk6IEhpc3RvcnlNYW5hZ2VyLFxuICAgIHByaXZhdGUgb25TdGF0ZUNoYW5nZT86IChzOiBHYW1lU3RhdGUpID0+IHZvaWRcbiAgKSB7fVxuXG4gIHByaXZhdGUgc2V0U3RhdGUoczogR2FtZVN0YXRlKSB7XG4gICAgdGhpcy5zdGF0ZSA9IHM7XG4gICAgaWYgKHRoaXMub25TdGF0ZUNoYW5nZSkgdGhpcy5vblN0YXRlQ2hhbmdlKHMpO1xuICB9XG5cbiAgLy8gaGVscGVyIMSR4buDIHjDs2EgYmV0IChhbiB0b8OgbilcbiAgY2xlYXJCZXQoKSB7XG4gICAgdGhpcy5jdXJyZW50QmV0ID0gbnVsbDtcbiAgICAvLyBraGkgY2xlYXIsIHRhIGPDsyB0aOG7gyBjaHV54buDbiB24buBIElkbGVcbiAgICB0aGlzLnNldFN0YXRlKCdJZGxlJyk7XG4gIH1cblxuICBzdGFydEJldHRpbmcoKSB7XG4gICAgdGhpcy5jbGVhckJldCgpO1xuICAgIHRoaXMuc2V0U3RhdGUoJ0JldHRpbmcnKTtcbiAgfVxuXG4gIHBsYWNlQmV0KGJldDogQmV0KSB7XG4gICAgaWYgKGJldC5hbW91bnQgPD0gMCkgdGhyb3cgbmV3IEVycm9yKCdCZXQgbXVzdCA+IDAnKTtcbiAgICBpZiAoYmV0LmFtb3VudCA+IHRoaXMuc2NvcmVNYW5hZ2VyLmJhbGFuY2UpIHRocm93IG5ldyBFcnJvcignTm90IGVub3VnaCBiYWxhbmNlJyk7XG5cbiAgICB0aGlzLmN1cnJlbnRCZXQgPSBiZXQ7XG4gICAgdGhpcy5zZXRTdGF0ZSgnQmV0dGluZycpO1xuICB9XG5cbiAgcm9sbCgpIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudEJldCkgdGhyb3cgbmV3IEVycm9yKCdObyBiZXQgcGxhY2VkIScpO1xuXG4gICAgLy8gYsaw4bubYyAxOiBjaHV54buDbiBzYW5nIFJvbGxpbmdcbiAgICB0aGlzLnNldFN0YXRlKCdSb2xsaW5nJyk7XG5cbiAgICAvLyBixrDhu5tjIDI6IGdpZW8geMO6YyB44bqvY1xuICAgIGNvbnN0IGRpY2UgPSB0aGlzLmRpY2VTZXJ2aWNlLnJvbGwoKTtcbiAgICB0aGlzLmxhc3REaWNlID0gZGljZTtcblxuICAgIC8vIGLGsOG7m2MgMzogdMOtbmgga+G6v3QgcXXhuqNcbiAgICBjb25zdCBjYWxjID0gY2FsY3VsYXRlUmVzdWx0KGRpY2UsIHRoaXMuY3VycmVudEJldCk7XG5cbiAgICAvLyBixrDhu5tjIDQ6IGNodXnhu4NuIHNhbmcgUmVzdWx0IChVSSBuw6puIGhp4buDbiB0aOG7iyBXSU4vTE9TRSBsw7pjIG7DoHkpXG4gICAgdGhpcy5zZXRTdGF0ZSgnUmVzdWx0Jyk7XG5cbiAgICAvLyBixrDhu5tjIDU6IGPhuq1wIG5o4bqtdCDEkWnhu4NtXG4gICAgdGhpcy5zY29yZU1hbmFnZXIuY2hhbmdlKGNhbGMuZGVsdGEpO1xuXG4gICAgLy8gYsaw4bubYyA2OiB04bqhbyByZWNvcmQgbOG7i2NoIHPhu60gY2h14bqpbiAoa2nhu4N1IFJvdW5kUmVjb3JkKVxuICAgIGNvbnN0IHJlY29yZDogUm91bmRSZWNvcmQgPSB7XG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGRpY2UsXG4gICAgICB0b3RhbDogY2FsYy50b3RhbCxcbiAgICAgIGJldDogdGhpcy5jdXJyZW50QmV0LFxuICAgICAgcmVzdWx0OiBjYWxjLndpbiA/ICdXSU4nIDogJ0xPU0UnLFxuICAgICAgYmFsYW5jZUFmdGVyOiB0aGlzLnNjb3JlTWFuYWdlci5iYWxhbmNlLFxuICAgIH07XG5cbiAgICAvLyBixrDhu5tjIDc6IGzGsHUgdsOgbyBIaXN0b3J5TWFuYWdlciAoZm9ybWF0IGhpc3RvcnkgVUkga2jDoWMsIEhpc3RvcnlNYW5hZ2VyIGNo4buLdSlcbiAgICB0aGlzLmhpc3RvcnkuYWRkKHtcbiAgICAgIHRpbWU6IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCksXG4gICAgICBkaWNlLFxuICAgICAgdG90YWw6IGNhbGMudG90YWwsXG4gICAgICBiZXRUeXBlOiB0aGlzLmN1cnJlbnRCZXQudHlwZSxcbiAgICAgIHJlc3VsdDogY2FsYy53aW4gPyAnV0lOJyA6ICdMT1NFJyxcbiAgICAgIGJhbGFuY2U6IHRoaXMuc2NvcmVNYW5hZ2VyLmJhbGFuY2UsXG4gICAgfSk7XG5cbiAgICAvLyBixrDhu5tjIDg6IHNldHRsZSBob8OgbiB04bqldFxuICAgIHRoaXMuc2V0U3RhdGUoJ1NldHRsZScpO1xuXG4gICAgLy8gcmVzZXQgYmV0IG5nYXkga2hpIHbDsm5nIGvhur90IHRow7pjIMSR4buDIHRyw6FuaCByZXVzZVxuICAgIHRoaXMuY3VycmVudEJldCA9IG51bGw7XG5cbiAgICAvLyB0cuG7nyB24buBIElkbGUgxJHhu4MgYuG6r3QgxJHhuqd1IHbDoW4gdGnhur9wIHRoZW9cbiAgICB0aGlzLnNldFN0YXRlKCdJZGxlJyk7XG5cbiAgICByZXR1cm4geyBkaWNlLCBjYWxjIH07XG4gIH1cbn1cbiIsImV4cG9ydCBpbnRlcmZhY2UgU3RvcmFnZUxpa2Uge1xuICBnZXRJdGVtKGtleTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbDtcbiAgc2V0SXRlbShrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBTY29yZU1hbmFnZXIge1xuICBwcml2YXRlIGtleTogc3RyaW5nO1xuICBwcml2YXRlIHN0b3JhZ2U6IFN0b3JhZ2VMaWtlO1xuICBiYWxhbmNlOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3Ioc3RvcmFnZTogU3RvcmFnZUxpa2UgPSB3aW5kb3cubG9jYWxTdG9yYWdlLCBrZXkgPSAnbWluaS1kaWNlLWJhbGFuY2UnKSB7XG4gICAgdGhpcy5zdG9yYWdlID0gc3RvcmFnZTtcbiAgICB0aGlzLmtleSA9IGtleTtcblxuICAgIGNvbnN0IHJhdyA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKHRoaXMua2V5KTtcblxuICAgIC8vIGNvbnZlcnQgc2FmZWx5XG4gICAgbGV0IHZhbCA9IHJhdyAhPT0gbnVsbCA/IE51bWJlcihyYXcpIDogTmFOO1xuXG4gICAgLy8gZmFsbGJhY2sgbuG6v3UgdmFsIGzDoCBOYU4gaG/hurdjIDwwXG4gICAgaWYgKGlzTmFOKHZhbCkgfHwgdmFsIDwgMCkge1xuICAgICAgdGhpcy5iYWxhbmNlID0gMTAwMDsgLy8gxJFp4buDbSBt4bq3YyDEkeG7i25oIGtoaSBi4bqvdCDEkeG6p3VcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5iYWxhbmNlID0gTWF0aC5mbG9vcih2YWwpOyAvLyDEkeG6o20gYuG6o28gbMOgIHPhu5Egbmd1ecOqblxuICAgIH1cblxuICAgIHRoaXMuc2F2ZSgpO1xuICB9XG5cbiAgY2hhbmdlKGRlbHRhOiBudW1iZXIpIHtcbiAgICB0aGlzLmJhbGFuY2UgKz0gZGVsdGE7XG4gICAgaWYgKHRoaXMuYmFsYW5jZSA8IDApIHRoaXMuYmFsYW5jZSA9IDA7XG4gICAgdGhpcy5zYXZlKCk7XG4gIH1cblxuICBzYXZlKCkge1xuICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKHRoaXMua2V5LCBTdHJpbmcodGhpcy5iYWxhbmNlKSk7XG4gIH1cbn1cbiJdfQ==