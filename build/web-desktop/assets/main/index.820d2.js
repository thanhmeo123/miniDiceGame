System.register("chunks:///_virtual/AudioManager.ts",["cc"],(function(){var c;return{setters:[function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"2d1c79XinZC3bhqLn3QcJ+f","AudioManager",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/BettingPanel.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"32c1fv1YgtNp6BM4merwgD+","BettingPanel",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/DiceService.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"86b0djSeXBMDZP8qEjrXNDC","DiceService",void 0);n("DiceService",function(){function n(n){this.rng=n}return n.prototype.roll=function(){return[this.rng.randInt(1,6),this.rng.randInt(1,6),this.rng.randInt(1,6)]},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/DiceView.ts",["cc"],(function(){var e;return{setters:[function(c){e=c.cclegacy}],execute:function(){e._RF.push({},"4484a0955JC5rC4ZhAr9y5N","DiceView",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RandomService.ts","./DiceService.ts","./ScoreManager.ts","./HistoryManager.ts","./RoundManager.ts"],(function(t){var e,n,i,r,a,o,l,u,s,c,h,p,b,g,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){a=t.cclegacy,o=t._decorator,l=t.Label,u=t.EditBox,s=t.Button,c=t.Component},function(t){h=t.RandomService},function(t){p=t.DiceService},function(t){b=t.ScoreManager},function(t){g=t.HistoryManager},function(t){f=t.RoundManager}],execute:function(){var B,d,y,L,m,I,v,w,T,G,z,M,S,N,R,x,A,D,H,O,U;a._RF.push({},"799c3LvFgNEh7ZPBNnElc/g","GameManager",void 0);var j=o.ccclass,E=o.property;t("GameManager",(B=j("GameManager"),d=E(l),y=E(l),L=E(l),m=E(l),I=E(u),v=E(u),w=E(s),T=E(s),G=E(s),B((S=e((M=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a))||this,i(e,"balanceLabel",S,r(e)),i(e,"resultLabel",N,r(e)),i(e,"diceLabel",R,r(e)),i(e,"historyLabel",x,r(e)),i(e,"amountInput",A,r(e)),i(e,"totalGuessInput",D,r(e)),i(e,"rollButton",H,r(e)),i(e,"taiButton",O,r(e)),i(e,"xiuButton",U,r(e)),e.round=void 0,e.score=void 0,e.history=void 0,e}n(e,t);var a=e.prototype;return a.onLoad=function(){var t=this,e=new h,n=new p(e);this.score=new b,this.history=new g,this.round=new f(n,this.score,this.history,(function(e){return t.onStateChange(e)})),this.updateBalance(),this.updateHistoryUI(),this.resetInputs()},a.onStateChange=function(t){"Rolling"===t&&(this.resultLabel.string="Rolling..."),"Settle"===t&&this.resetInputs()},a.updateBalance=function(){this.balanceLabel.string="Balance: "+this.score.balance},a.updateHistoryUI=function(){var t=this.history.histories,e=[].concat(t).reverse().map((function(t){return t.time+" | "+t.dice.join(",")+" | "+t.total+" | "+t.betType+" | "+t.result+" | "+t.balance}));this.historyLabel.string=e.join("\n")},a.resetInputs=function(){this.amountInput.string="",this.totalGuessInput.string="",this.rollButton&&(this.rollButton.interactable=!1),this.taiButton&&(this.taiButton.interactable=!0),this.xiuButton&&(this.xiuButton.interactable=!0),this.totalGuessInput&&(this.totalGuessInput.enabled=!0)},a.placeBetTai=function(){this.placeBet("TAI")},a.placeBetXiu=function(){this.placeBet("XIU")},a.placeBetTotal=function(){this.placeBet("TOTAL")},a.placeBet=function(t){var e,n=parseInt(this.amountInput.string||"0",10);if(n<=0||isNaN(n))return this.resultLabel.string="Nhập số điểm hợp lệ!",void(this.rollButton&&(this.rollButton.interactable=!1));if("TOTAL"===t&&(e=parseInt(this.totalGuessInput.string||"0",10),isNaN(e)||e<3||e>18))return this.resultLabel.string="Nhập tổng hợp lệ (3-18)!",void(this.rollButton&&(this.rollButton.interactable=!1));try{"TOTAL"===t?(this.round.placeBet({type:t,amount:n,totalGuess:e}),this.taiButton&&(this.taiButton.interactable=!1),this.xiuButton&&(this.xiuButton.interactable=!1)):(this.round.placeBet({type:t,amount:n}),this.totalGuessInput&&(this.totalGuessInput.enabled=!1)),this.resultLabel.string="Đặt "+n+" vào "+t+("TOTAL"===t?" (Tổng: "+e+")":""),this.rollButton&&(this.rollButton.interactable=!0)}catch(t){this.resultLabel.string="Lỗi: "+t.message,this.rollButton&&(this.rollButton.interactable=!1)}},a.onRoll=function(){try{if(!this.round.currentBet)return void(this.resultLabel.string="Bạn chưa đặt cược!");var t=this.round.roll(),e=t.dice,n=t.calc,i=n.total,r=n.delta,a="";a=i>=11&&i<=17?"TAI":i>=4&&i<=10?"XIU":"—",this.diceLabel.string="Dice: "+e.join("/")+" (Total: "+i+", "+a+")",this.resultLabel.string=n.win?"WIN (+"+r+")":"LOSE ("+r+")",this.updateBalance(),this.updateHistoryUI(),this.resetInputs()}catch(t){this.resultLabel.string="Lỗi: "+t.message}},e}(c)).prototype,"balanceLabel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(M.prototype,"resultLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(M.prototype,"diceLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(M.prototype,"historyLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(M.prototype,"amountInput",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(M.prototype,"totalGuessInput",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(M.prototype,"rollButton",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(M.prototype,"taiButton",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(M.prototype,"xiuButton",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=M))||z));a._RF.pop()}}}));

System.register("chunks:///_virtual/HistoryManager.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"213e925BkFJ7KXlDE+vkHwF","HistoryManager",void 0);t("HistoryManager",function(){function t(t){void 0===t&&(t=window.localStorage),this.key="mini-dice-history",this.maxRecords=10,this.storage=void 0,this.histories=[],this.storage=t;var i=this.storage.getItem(this.key);if(i)try{this.histories=JSON.parse(i)}catch(t){this.histories=[]}}var i=t.prototype;return i.add=function(t){this.histories.unshift(t),this.histories.length>this.maxRecords&&(this.histories=this.histories.slice(0,this.maxRecords)),this.save()},i.save=function(){this.storage.setItem(this.key,JSON.stringify(this.histories))},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/HistoryView.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"d2d653qHi1PhbNIyAg8uGJH","HistoryView",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./DiceService.ts","./HistoryManager.ts","./RandomService.ts","./ResultCalculator.ts","./RoundManager.ts","./ScoreManager.ts","./models.ts","./AudioManager.ts","./BettingPanel.ts","./DiceView.ts","./GameManager.ts","./HistoryView.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/models.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"43810rY185EnIllJP8uwCVu","models",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/RandomService.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"103e7+lX6lLFq0uGPns2rm0","RandomService",void 0);n("RandomService",function(){function n(n){void 0===n&&(n=Math.random),this.randFn=n}return n.prototype.randInt=function(n,t){return Math.floor(this.randFn()*(t-n+1))+n},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/ResultCalculator.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){t("calculateResult",(function(t,e){var u=t.reduce((function(t,e){return t+e}),0),c=!1,l=0,n=u>=11&&u<=17,r=u>=4&&u<=10;"TAI"===e.type?(c=n,l=1):"XIU"===e.type?(c=r,l=1):"TOTAL"===e.type&&(c=e.totalGuess===u,l=5);var a=c?e.amount*l:-e.amount;return{total:u,win:c,multiplier:l,delta:a,betType:e.type}})),e._RF.push({},"65016/ZbGlJXJmc2ZPPxj7q","ResultCalculator",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/RoundManager.ts",["cc","./ResultCalculator.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.calculateResult}],execute:function(){e._RF.push({},"68ecepqR5NHOZdkfmYH7k8v","RoundManager",void 0);t("RoundManager",function(){function t(t,e,n,a){this.state="Idle",this.currentBet=null,this.lastDice=null,this.diceService=t,this.scoreManager=e,this.history=n,this.onStateChange=a}var e=t.prototype;return e.setState=function(t){this.state=t,this.onStateChange&&this.onStateChange(t)},e.clearBet=function(){this.currentBet=null,this.setState("Idle")},e.startBetting=function(){this.clearBet(),this.setState("Betting")},e.placeBet=function(t){if(t.amount<=0)throw new Error("Bet must > 0");if(t.amount>this.scoreManager.balance)throw new Error("Not enough balance");this.currentBet=t,this.setState("Betting")},e.roll=function(){if(!this.currentBet)throw new Error("No bet placed!");this.setState("Rolling");var t=this.diceService.roll();this.lastDice=t;var e=n(t,this.currentBet);this.setState("Result"),this.scoreManager.change(e.delta);(new Date).toISOString(),e.total,this.currentBet,e.win,this.scoreManager.balance;return this.history.add({time:(new Date).toLocaleTimeString(),dice:t,total:e.total,betType:this.currentBet.type,result:e.win?"WIN":"LOSE",balance:this.scoreManager.balance}),this.setState("Settle"),this.currentBet=null,this.setState("Idle"),{dice:t,calc:e}},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/ScoreManager.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"4aba9USSxlI/YTUTU1g2mF4","ScoreManager",void 0);e("ScoreManager",function(){function e(e,t){void 0===e&&(e=window.localStorage),void 0===t&&(t="mini-dice-balance"),this.key=void 0,this.storage=void 0,this.balance=void 0,this.storage=e,this.key=t;var a=this.storage.getItem(this.key),i=null!==a?Number(a):NaN;isNaN(i)||i<0?this.balance=1e3:this.balance=Math.floor(i),this.save()}var t=e.prototype;return t.change=function(e){this.balance+=e,this.balance<0&&(this.balance=0),this.save()},t.save=function(){this.storage.setItem(this.key,String(this.balance))},e}());t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL0RpY2VTZXJ2aWNlLnRzIiwiLi4vZmlsZTovRDovY29jb3MvTWluaURpY2VHYW1lL2Fzc2V0cy9zY3JpcHRzL3VpL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy91aS9HYW1lTWFuYWdlci50cyIsIi4uL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL0hpc3RvcnlNYW5hZ2VyLnRzIiwiLi4vZmlsZTovRDovY29jb3MvTWluaURpY2VHYW1lL2Fzc2V0cy9zY3JpcHRzL2NvcmUvZmlsZTovRDovY29jb3MvTWluaURpY2VHYW1lL2Fzc2V0cy9zY3JpcHRzL2NvcmUvUmFuZG9tU2VydmljZS50cyIsIi4uL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL2ZpbGU6L0Q6L2NvY29zL01pbmlEaWNlR2FtZS9hc3NldHMvc2NyaXB0cy9jb3JlL1Jlc3VsdENhbGN1bGF0b3IudHMiLCIuLi9maWxlOi9EOi9jb2Nvcy9NaW5pRGljZUdhbWUvYXNzZXRzL3NjcmlwdHMvY29yZS9maWxlOi9EOi9jb2Nvcy9NaW5pRGljZUdhbWUvYXNzZXRzL3NjcmlwdHMvY29yZS9Sb3VuZE1hbmFnZXIudHMiLCIuLi9maWxlOi9EOi9jb2Nvcy9NaW5pRGljZUdhbWUvYXNzZXRzL3NjcmlwdHMvY29yZS9maWxlOi9EOi9jb2Nvcy9NaW5pRGljZUdhbWUvYXNzZXRzL3NjcmlwdHMvY29yZS9TY29yZU1hbmFnZXIudHMiXSwibmFtZXMiOlsiRGljZVNlcnZpY2UiLCJybmciLCJ0aGlzIiwicHJvdG90eXBlIiwicm9sbCIsInJhbmRJbnQiLCJfUkYiLCJwb3AiLCJjY2NsYXNzIiwiX2RlY29yYXRvciIsInByb3BlcnR5IiwiX2RlYyIsIl9kZWMyIiwiTGFiZWwiLCJfZGVjMyIsIl9kZWM0IiwiX2RlYzUiLCJfZGVjNiIsIkVkaXRCb3giLCJfZGVjNyIsIl9kZWM4IiwiQnV0dG9uIiwiX2RlYzkiLCJfZGVjMTAiLCJfZGVzY3JpcHRvciIsIl9hcHBseURlY29yYXRlZERlc2NyaXB0b3IiLCJfY2xhc3MyIiwiX0NvbXBvbmVudCIsIkdhbWVNYW5hZ2VyIiwiX3RoaXMiLCJfbGVuIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiYXJncyIsIkFycmF5IiwiX2tleSIsImNhbGwiLCJhcHBseSIsImNvbmNhdCIsIl9pbml0aWFsaXplckRlZmluZVByb3BlcnR5IiwiX2Fzc2VydFRoaXNJbml0aWFsaXplZCIsIl9kZXNjcmlwdG9yMiIsIl9kZXNjcmlwdG9yMyIsIl9kZXNjcmlwdG9yNCIsIl9kZXNjcmlwdG9yNSIsIl9kZXNjcmlwdG9yNiIsIl9kZXNjcmlwdG9yNyIsIl9kZXNjcmlwdG9yOCIsIl9kZXNjcmlwdG9yOSIsInJvdW5kIiwic2NvcmUiLCJoaXN0b3J5IiwiX2luaGVyaXRzTG9vc2UiLCJfcHJvdG8iLCJvbkxvYWQiLCJfdGhpczIiLCJSYW5kb21TZXJ2aWNlIiwiZGljZVNlcnZpY2UiLCJTY29yZU1hbmFnZXIiLCJIaXN0b3J5TWFuYWdlciIsIlJvdW5kTWFuYWdlciIsInMiLCJvblN0YXRlQ2hhbmdlIiwidXBkYXRlQmFsYW5jZSIsInVwZGF0ZUhpc3RvcnlVSSIsInJlc2V0SW5wdXRzIiwicmVzdWx0TGFiZWwiLCJzdHJpbmciLCJiYWxhbmNlTGFiZWwiLCJiYWxhbmNlIiwibGlzdCIsImhpc3RvcmllcyIsImxpbmVzIiwicmV2ZXJzZSIsIm1hcCIsImgiLCJ0aW1lIiwiZGljZSIsImpvaW4iLCJ0b3RhbCIsImJldFR5cGUiLCJyZXN1bHQiLCJoaXN0b3J5TGFiZWwiLCJhbW91bnRJbnB1dCIsInRvdGFsR3Vlc3NJbnB1dCIsInJvbGxCdXR0b24iLCJpbnRlcmFjdGFibGUiLCJ0YWlCdXR0b24iLCJ4aXVCdXR0b24iLCJlbmFibGVkIiwicGxhY2VCZXRUYWkiLCJwbGFjZUJldCIsInBsYWNlQmV0WGl1IiwicGxhY2VCZXRUb3RhbCIsInR5cGUiLCJndWVzcyIsImFtdCIsInBhcnNlSW50IiwiaXNOYU4iLCJhbW91bnQiLCJ0b3RhbEd1ZXNzIiwiZSIsIm1lc3NhZ2UiLCJvblJvbGwiLCJjdXJyZW50QmV0IiwiX3RoaXMkcm91bmQkcm9sbCIsImNhbGMiLCJkZWx0YSIsInRhaVhpdSIsImRpY2VMYWJlbCIsIndpbiIsImVyciIsIkNvbXBvbmVudCIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImluaXRpYWxpemVyIiwiX2NsYXNzIiwic3RvcmFnZSIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsImtleSIsIm1heFJlY29yZHMiLCJyYXciLCJnZXRJdGVtIiwiSlNPTiIsInBhcnNlIiwiX3VudXNlZCIsImFkZCIsInJlY29yZCIsInVuc2hpZnQiLCJzbGljZSIsInNhdmUiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwicmFuZEZuIiwiTWF0aCIsInJhbmRvbSIsIm1pbiIsIm1heCIsImZsb29yIiwiYmV0IiwicmVkdWNlIiwidiIsIm11bHRpcGxpZXIiLCJpc1RhaSIsImlzWGl1Iiwic2NvcmVNYW5hZ2VyIiwic3RhdGUiLCJsYXN0RGljZSIsInNldFN0YXRlIiwiY2xlYXJCZXQiLCJzdGFydEJldHRpbmciLCJFcnJvciIsImNhbGN1bGF0ZVJlc3VsdCIsImNoYW5nZSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInRvTG9jYWxlVGltZVN0cmluZyIsInZhbCIsIk51bWJlciIsIk5hTiIsIlN0cmluZyJdLCJtYXBwaW5ncyI6Ijs7OztxT0FHRSxTQUFBQSxFQUFvQkMsR0FBb0JDLEtBQXBCRCxJQUFBQSxFQVFuQixPQVJ5Q0QsRUFBQUcsVUFFMUNDLEtBQUEsV0FDRSxNQUFPLENBQ0xGLEtBQUtELElBQUlJ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SUFBQUEsRUFBTSxxQkFBbUJ2SCxLQUp6RXVILFdBQUd2SCxLQUNIb0gsZUFBT3BILEtBQ2ZtRSxlQUdFbkUsS0FBS29ILFFBQVVBLEVBQ2ZwSCxLQUFLdUgsSUFBTUEsRUFFWCxJQUFNRSxFQUFNekgsS0FBS29ILFFBQVFNLFFBQVExSCxLQUFLdUgsS0FHbENzQyxFQUFjLE9BQVJwQyxFQUFlcUMsT0FBT3JDLEdBQU9zQyxJQUduQy9ELE1BQU02RCxJQUFRQSxFQUFNLEVBQ3RCN0osS0FBS21FLFFBQVUsSUFFZm5FLEtBQUttRSxRQUFVbUUsS0FBS0ksTUFBTW1CLEdBRzVCN0osS0FBS2tJLE9BQ04sSUFBQS9FLEVBQUFLLEVBQUF2RCxVQVVBLE9BVkFrRCxFQUVEc0csT0FBQSxTQUFPaEQsR0FDTHpHLEtBQUttRSxTQUFXc0MsRUFDWnpHLEtBQUttRSxRQUFVLElBQUduRSxLQUFLbUUsUUFBVSxHQUNyQ25FLEtBQUtrSSxRQUNOL0UsRUFFRCtFLEtBQUEsV0FDRWxJLEtBQUtvSCxRQUFRZSxRQUFRbkksS0FBS3VILElBQUt5QyxPQUFPaEssS0FBS21FLFdBQzVDWCxRQUNGcEQsSUFBQUMiLCJmaWxlIjoiYWxsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmFuZG9tU2VydmljZSB9IGZyb20gJy4vUmFuZG9tU2VydmljZSc7XHJcblxyXG5leHBvcnQgY2xhc3MgRGljZVNlcnZpY2Uge1xyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcm5nOiBSYW5kb21TZXJ2aWNlKSB7fVxyXG5cclxuICByb2xsKCk6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICB0aGlzLnJuZy5yYW5kSW50KDEsIDYpLFxyXG4gICAgICB0aGlzLnJuZy5yYW5kSW50KDEsIDYpLFxyXG4gICAgICB0aGlzLnJuZy5yYW5kSW50KDEsIDYpLFxyXG4gICAgXTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgX2RlY29yYXRvciwgQ29tcG9uZW50LCBMYWJlbCwgQnV0dG9uLCBFZGl0Qm94IH0gZnJvbSAnY2MnO1xyXG5pbXBvcnQgeyBSYW5kb21TZXJ2aWNlIH0gZnJvbSAnLi4vY29yZS9SYW5kb21TZXJ2aWNlJztcclxuaW1wb3J0IHsgRGljZVNlcnZpY2UgfSBmcm9tICcuLi9jb3JlL0RpY2VTZXJ2aWNlJztcclxuaW1wb3J0IHsgU2NvcmVNYW5hZ2VyIH0gZnJvbSAnLi4vY29yZS9TY29yZU1hbmFnZXInO1xyXG5pbXBvcnQgeyBIaXN0b3J5TWFuYWdlciB9IGZyb20gJy4uL2NvcmUvSGlzdG9yeU1hbmFnZXInO1xyXG5pbXBvcnQgeyBSb3VuZE1hbmFnZXIgfSBmcm9tICcuLi9jb3JlL1JvdW5kTWFuYWdlcic7XHJcblxyXG5jb25zdCB7IGNjY2xhc3MsIHByb3BlcnR5IH0gPSBfZGVjb3JhdG9yO1xyXG5cclxuQGNjY2xhc3MoJ0dhbWVNYW5hZ2VyJylcclxuZXhwb3J0IGNsYXNzIEdhbWVNYW5hZ2VyIGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICBAcHJvcGVydHkoTGFiZWwpIGJhbGFuY2VMYWJlbDogTGFiZWwgPSBudWxsITtcclxuICBAcHJvcGVydHkoTGFiZWwpIHJlc3VsdExhYmVsOiBMYWJlbCA9IG51bGwhO1xyXG4gIEBwcm9wZXJ0eShMYWJlbCkgZGljZUxhYmVsOiBMYWJlbCA9IG51bGwhO1xyXG4gIEBwcm9wZXJ0eShMYWJlbCkgaGlzdG9yeUxhYmVsOiBMYWJlbCA9IG51bGwhO1xyXG4gIEBwcm9wZXJ0eShFZGl0Qm94KSBhbW91bnRJbnB1dDogRWRpdEJveCA9IG51bGwhO1xyXG4gIEBwcm9wZXJ0eShFZGl0Qm94KSB0b3RhbEd1ZXNzSW5wdXQ6IEVkaXRCb3ggPSBudWxsITtcclxuICBAcHJvcGVydHkoQnV0dG9uKSByb2xsQnV0dG9uOiBCdXR0b24gPSBudWxsITtcclxuICBAcHJvcGVydHkoQnV0dG9uKSB0YWlCdXR0b246IEJ1dHRvbiA9IG51bGwhO1xyXG4gIEBwcm9wZXJ0eShCdXR0b24pIHhpdUJ1dHRvbjogQnV0dG9uID0gbnVsbCE7XHJcblxyXG4gIHByaXZhdGUgcm91bmQhOiBSb3VuZE1hbmFnZXI7XHJcbiAgcHJpdmF0ZSBzY29yZSE6IFNjb3JlTWFuYWdlcjtcclxuICBwcml2YXRlIGhpc3RvcnkhOiBIaXN0b3J5TWFuYWdlcjtcclxuXHJcbiAgb25Mb2FkKCkge1xyXG4gICAgY29uc3Qgcm5nID0gbmV3IFJhbmRvbVNlcnZpY2UoKTtcclxuICAgIGNvbnN0IGRpY2VTZXJ2aWNlID0gbmV3IERpY2VTZXJ2aWNlKHJuZyk7XHJcbiAgICB0aGlzLnNjb3JlID0gbmV3IFNjb3JlTWFuYWdlcigpO1xyXG4gICAgdGhpcy5oaXN0b3J5ID0gbmV3IEhpc3RvcnlNYW5hZ2VyKCk7XHJcbiAgICB0aGlzLnJvdW5kID0gbmV3IFJvdW5kTWFuYWdlcihcclxuICAgICAgZGljZVNlcnZpY2UsXHJcbiAgICAgIHRoaXMuc2NvcmUsXHJcbiAgICAgIHRoaXMuaGlzdG9yeSxcclxuICAgICAgKHM6IHN0cmluZykgPT4gdGhpcy5vblN0YXRlQ2hhbmdlKHMpXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMudXBkYXRlQmFsYW5jZSgpO1xyXG4gICAgdGhpcy51cGRhdGVIaXN0b3J5VUkoKTtcclxuICAgIHRoaXMucmVzZXRJbnB1dHMoKTtcclxuICB9XHJcblxyXG4gIG9uU3RhdGVDaGFuZ2Uoczogc3RyaW5nKSB7XHJcbiAgICBpZiAocyA9PT0gJ1JvbGxpbmcnKSB7XHJcbiAgICAgIHRoaXMucmVzdWx0TGFiZWwuc3RyaW5nID0gXCJSb2xsaW5nLi4uXCI7XHJcbiAgICB9XHJcbiAgICBpZiAocyA9PT0gJ1NldHRsZScpIHtcclxuICAgICAgdGhpcy5yZXNldElucHV0cygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgdXBkYXRlQmFsYW5jZSgpIHtcclxuICAgIHRoaXMuYmFsYW5jZUxhYmVsLnN0cmluZyA9IGBCYWxhbmNlOiAke3RoaXMuc2NvcmUuYmFsYW5jZX1gO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlSGlzdG9yeVVJKCkge1xyXG4gICAgY29uc3QgbGlzdCA9IHRoaXMuaGlzdG9yeS5oaXN0b3JpZXM7XHJcbiAgICBjb25zdCBsaW5lcyA9IFsuLi5saXN0XS5yZXZlcnNlKCkubWFwKGggPT4ge1xyXG4gICAgICByZXR1cm4gYCR7aC50aW1lfSB8ICR7aC5kaWNlLmpvaW4oJywnKX0gfCAke2gudG90YWx9IHwgJHtoLmJldFR5cGV9IHwgJHtoLnJlc3VsdH0gfCAke2guYmFsYW5jZX1gO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLmhpc3RvcnlMYWJlbC5zdHJpbmcgPSBsaW5lcy5qb2luKCdcXG4nKTtcclxuICB9XHJcblxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgLy8gUmVzZXQgSW5wdXRzIHNhdSBt4buXaSB2w7JuZ1xyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgcmVzZXRJbnB1dHMoKSB7XHJcbiAgICB0aGlzLmFtb3VudElucHV0LnN0cmluZyA9ICcnO1xyXG4gICAgdGhpcy50b3RhbEd1ZXNzSW5wdXQuc3RyaW5nID0gJyc7XHJcbiAgICBpZiAodGhpcy5yb2xsQnV0dG9uKSB0aGlzLnJvbGxCdXR0b24uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICBpZiAodGhpcy50YWlCdXR0b24pIHRoaXMudGFpQnV0dG9uLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICBpZiAodGhpcy54aXVCdXR0b24pIHRoaXMueGl1QnV0dG9uLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICBpZiAodGhpcy50b3RhbEd1ZXNzSW5wdXQpIHRoaXMudG90YWxHdWVzc0lucHV0LmVuYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyDEkOG6t3QgY8aw4bujY1xyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgcGxhY2VCZXRUYWkoKSB7XHJcbiAgICB0aGlzLnBsYWNlQmV0KCdUQUknKTtcclxuICB9XHJcblxyXG4gIHBsYWNlQmV0WGl1KCkge1xyXG4gICAgdGhpcy5wbGFjZUJldCgnWElVJyk7XHJcbiAgfVxyXG5cclxuICBwbGFjZUJldFRvdGFsKCkge1xyXG4gICAgdGhpcy5wbGFjZUJldCgnVE9UQUwnKTtcclxuICB9XHJcblxyXG4gIHBsYWNlQmV0KHR5cGU6ICdUQUknIHwgJ1hJVScgfCAnVE9UQUwnKSB7XHJcbiAgICBjb25zdCBhbXQgPSBwYXJzZUludCh0aGlzLmFtb3VudElucHV0LnN0cmluZyB8fCAnMCcsIDEwKTtcclxuICAgIGlmIChhbXQgPD0gMCB8fCBpc05hTihhbXQpKSB7XHJcbiAgICAgIHRoaXMucmVzdWx0TGFiZWwuc3RyaW5nID0gJ05o4bqtcCBz4buRIMSRaeG7g20gaOG7o3AgbOG7hyEnO1xyXG4gICAgICBpZiAodGhpcy5yb2xsQnV0dG9uKSB0aGlzLnJvbGxCdXR0b24uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgZ3Vlc3M6IG51bWJlciB8IHVuZGVmaW5lZDtcclxuXHJcbiAgICBpZiAodHlwZSA9PT0gJ1RPVEFMJykge1xyXG4gICAgICBndWVzcyA9IHBhcnNlSW50KHRoaXMudG90YWxHdWVzc0lucHV0LnN0cmluZyB8fCAnMCcsIDEwKTtcclxuICAgICAgaWYgKGlzTmFOKGd1ZXNzKSB8fCBndWVzcyA8IDMgfHwgZ3Vlc3MgPiAxOCkge1xyXG4gICAgICAgIHRoaXMucmVzdWx0TGFiZWwuc3RyaW5nID0gJ05o4bqtcCB04buVbmcgaOG7o3AgbOG7hyAoMy0xOCkhJztcclxuICAgICAgICBpZiAodGhpcy5yb2xsQnV0dG9uKSB0aGlzLnJvbGxCdXR0b24uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKHR5cGUgPT09ICdUT1RBTCcpIHtcclxuICAgICAgICB0aGlzLnJvdW5kLnBsYWNlQmV0KHsgdHlwZSwgYW1vdW50OiBhbXQsIHRvdGFsR3Vlc3M6IGd1ZXNzIH0pO1xyXG4gICAgICAgIC8vIGRpc2FibGUgMiBuw7p0IFTDoGkvWOG7iXVcclxuICAgICAgICBpZiAodGhpcy50YWlCdXR0b24pIHRoaXMudGFpQnV0dG9uLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLnhpdUJ1dHRvbikgdGhpcy54aXVCdXR0b24uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5yb3VuZC5wbGFjZUJldCh7IHR5cGUsIGFtb3VudDogYW10IH0pO1xyXG4gICAgICAgIC8vIGRpc2FibGUgw7Qgbmjhuq1wIHThu5VuZ1xyXG4gICAgICAgIGlmICh0aGlzLnRvdGFsR3Vlc3NJbnB1dCkgdGhpcy50b3RhbEd1ZXNzSW5wdXQuZW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLnJlc3VsdExhYmVsLnN0cmluZyA9IGDEkOG6t3QgJHthbXR9IHbDoG8gJHt0eXBlfSR7dHlwZSA9PT0gJ1RPVEFMJyA/IGAgKFThu5VuZzogJHtndWVzc30pYCA6ICcnfWA7XHJcbiAgICAgIGlmICh0aGlzLnJvbGxCdXR0b24pIHRoaXMucm9sbEJ1dHRvbi5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG5cclxuICAgIH0gY2F0Y2ggKGU6IGFueSkge1xyXG4gICAgICB0aGlzLnJlc3VsdExhYmVsLnN0cmluZyA9IGBM4buXaTogJHtlLm1lc3NhZ2V9YDtcclxuICAgICAgaWYgKHRoaXMucm9sbEJ1dHRvbikgdGhpcy5yb2xsQnV0dG9uLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyBSb2xsXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICBvblJvbGwoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAoIXRoaXMucm91bmQuY3VycmVudEJldCkge1xyXG4gICAgICAgIHRoaXMucmVzdWx0TGFiZWwuc3RyaW5nID0gJ0LhuqFuIGNoxrBhIMSR4bq3dCBjxrDhu6NjISc7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB7IGRpY2UsIGNhbGMgfSA9IHRoaXMucm91bmQucm9sbCgpO1xyXG5cclxuICAgICAgY29uc3QgdG90YWwgPSBjYWxjLnRvdGFsO1xyXG4gICAgICBjb25zdCBkZWx0YSA9IGNhbGMuZGVsdGE7XHJcblxyXG4gICAgICAvLyBUw6BpL1jhu4l1IHRleHQgdOG7qyB04buVbmdcclxuICAgICAgbGV0IHRhaVhpdSA9ICcnO1xyXG4gICAgICBpZiAodG90YWwgPj0gMTEgJiYgdG90YWwgPD0gMTcpIHRhaVhpdSA9ICdUQUknO1xyXG4gICAgICBlbHNlIGlmICh0b3RhbCA+PSA0ICYmIHRvdGFsIDw9IDEwKSB0YWlYaXUgPSAnWElVJztcclxuICAgICAgZWxzZSB0YWlYaXUgPSAn4oCUJztcclxuXHJcbiAgICAgIC8vIEhp4buDbiB0aOG7iyB4w7pjIHjhuq9jXHJcbiAgICAgIHRoaXMuZGljZUxhYmVsLnN0cmluZyA9IGBEaWNlOiAke2RpY2Uuam9pbignLycpfSAoVG90YWw6ICR7dG90YWx9LCAke3RhaVhpdX0pYDtcclxuXHJcbiAgICAgIC8vIEhp4buDbiB0aOG7iyBr4bq/dCBxdeG6o1xyXG4gICAgICB0aGlzLnJlc3VsdExhYmVsLnN0cmluZyA9IGNhbGMud2luXHJcbiAgICAgICAgPyBgV0lOICgrJHtkZWx0YX0pYFxyXG4gICAgICAgIDogYExPU0UgKCR7ZGVsdGF9KWA7XHJcblxyXG4gICAgICB0aGlzLnVwZGF0ZUJhbGFuY2UoKTtcclxuICAgICAgdGhpcy51cGRhdGVIaXN0b3J5VUkoKTtcclxuXHJcbiAgICAgIC8vIFNhdSBSb2xsIHhvbmcsIHJlc2V0IMSR4buDIGNodeG6qW4gYuG7iyB2w7JuZyBt4bubaVxyXG4gICAgICB0aGlzLnJlc2V0SW5wdXRzKCk7XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcclxuICAgICAgdGhpcy5yZXN1bHRMYWJlbC5zdHJpbmcgPSBgTOG7l2k6ICR7ZXJyLm1lc3NhZ2V9YDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGludGVyZmFjZSBSb3VuZEhpc3Rvcnkge1xyXG4gIHRpbWU6IHN0cmluZzsgICAgICAvLyB0aOG7nWkgZ2lhbiB2w6FuIGNoxqFpXHJcbiAgZGljZTogbnVtYmVyW107ICAgIC8vIDMgbeG6t3QgeMO6YyB44bqvY1xyXG4gIHRvdGFsOiBudW1iZXI7ICAgICAvLyB04buVbmcgxJFp4buDbVxyXG4gIGJldFR5cGU6IHN0cmluZzsgICAvLyBUQUkgLyBYSVUgLyBUT1RBTC14XHJcbiAgcmVzdWx0OiBzdHJpbmc7ICAgIC8vIFdJTiAvIExPU0VcclxuICBiYWxhbmNlOiBudW1iZXI7ICAgLy8gxJFp4buDbSBzYXUgdsOhblxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgSGlzdG9yeU1hbmFnZXIge1xyXG4gIHByaXZhdGUga2V5ID0gJ21pbmktZGljZS1oaXN0b3J5JztcclxuICBwcml2YXRlIG1heFJlY29yZHMgPSAxMDtcclxuICBwcml2YXRlIHN0b3JhZ2U6IFN0b3JhZ2U7XHJcblxyXG4gIGhpc3RvcmllczogUm91bmRIaXN0b3J5W10gPSBbXTtcclxuXHJcbiAgY29uc3RydWN0b3Ioc3RvcmFnZTogU3RvcmFnZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcclxuICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XHJcbiAgICBjb25zdCByYXcgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmtleSk7XHJcbiAgICBpZiAocmF3KSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgdGhpcy5oaXN0b3JpZXMgPSBKU09OLnBhcnNlKHJhdyk7XHJcbiAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgIHRoaXMuaGlzdG9yaWVzID0gW107XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFkZChyZWNvcmQ6IFJvdW5kSGlzdG9yeSkge1xyXG4gICAgdGhpcy5oaXN0b3JpZXMudW5zaGlmdChyZWNvcmQpOyAvLyB0aMOqbSB2w6BvIMSR4bqndSBkYW5oIHPDoWNoXHJcbiAgICBpZiAodGhpcy5oaXN0b3JpZXMubGVuZ3RoID4gdGhpcy5tYXhSZWNvcmRzKSB7XHJcbiAgICAgIHRoaXMuaGlzdG9yaWVzID0gdGhpcy5oaXN0b3JpZXMuc2xpY2UoMCwgdGhpcy5tYXhSZWNvcmRzKTsgLy8gZ2nhu68gbOG6oWkgMTAgYuG6o24gZ2hpXHJcbiAgICB9XHJcbiAgICB0aGlzLnNhdmUoKTtcclxuICB9XHJcblxyXG4gIHNhdmUoKSB7XHJcbiAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbSh0aGlzLmtleSwgSlNPTi5zdHJpbmdpZnkodGhpcy5oaXN0b3JpZXMpKTtcclxuICB9XHJcbn0iLCJleHBvcnQgdHlwZSBSYW5kRm4gPSAoKSA9PiBudW1iZXI7XHJcblxyXG5leHBvcnQgY2xhc3MgUmFuZG9tU2VydmljZSB7XHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByYW5kRm46IFJhbmRGbiA9IE1hdGgucmFuZG9tKSB7fVxyXG5cclxuICByYW5kSW50KG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICByZXR1cm4gTWF0aC5mbG9vcih0aGlzLnJhbmRGbigpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQmV0IH0gZnJvbSAnLi9tb2RlbHMnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDYWxjUmVzdWx0IHtcclxuICB0b3RhbDogbnVtYmVyO1xyXG4gIHdpbjogYm9vbGVhbjtcclxuICBtdWx0aXBsaWVyOiBudW1iZXI7XHJcbiAgZGVsdGE6IG51bWJlcjtcclxuICBiZXRUeXBlOiBzdHJpbmc7IFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlUmVzdWx0KGRpY2U6IG51bWJlcltdLCBiZXQ6IEJldCk6IENhbGNSZXN1bHQge1xyXG4gIGNvbnN0IHRvdGFsID0gZGljZS5yZWR1Y2UoKHMsIHYpID0+IHMgKyB2LCAwKTtcclxuICBsZXQgd2luID0gZmFsc2U7XHJcbiAgbGV0IG11bHRpcGxpZXIgPSAwO1xyXG5cclxuICBjb25zdCBpc1RhaSA9IHRvdGFsID49IDExICYmIHRvdGFsIDw9IDE3O1xyXG4gIGNvbnN0IGlzWGl1ID0gdG90YWwgPj0gNCAmJiB0b3RhbCA8PSAxMDtcclxuXHJcbiAgaWYgKGJldC50eXBlID09PSAnVEFJJykge1xyXG4gICAgd2luID0gaXNUYWk7XHJcbiAgICBtdWx0aXBsaWVyID0gMTtcclxuICB9IGVsc2UgaWYgKGJldC50eXBlID09PSAnWElVJykge1xyXG4gICAgd2luID0gaXNYaXU7XHJcbiAgICBtdWx0aXBsaWVyID0gMTtcclxuICB9IGVsc2UgaWYgKGJldC50eXBlID09PSAnVE9UQUwnKSB7XHJcbiAgICB3aW4gPSBiZXQudG90YWxHdWVzcyA9PT0gdG90YWw7XHJcbiAgICBtdWx0aXBsaWVyID0gNTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGRlbHRhID0gd2luID8gYmV0LmFtb3VudCAqIG11bHRpcGxpZXIgOiAtYmV0LmFtb3VudDtcclxuICByZXR1cm4geyB0b3RhbCwgd2luLCBtdWx0aXBsaWVyLCBkZWx0YSwgYmV0VHlwZTogYmV0LnR5cGUgfTsgLy8gdGjDqm0g4bufIMSRw6J5XHJcbn1cclxuIiwiLy8gYXNzZXRzL3NjcmlwdHMvY29yZS9Sb3VuZE1hbmFnZXIudHNcclxuaW1wb3J0IHsgRGljZVNlcnZpY2UgfSBmcm9tICcuL0RpY2VTZXJ2aWNlJztcclxuaW1wb3J0IHsgU2NvcmVNYW5hZ2VyIH0gZnJvbSAnLi9TY29yZU1hbmFnZXInO1xyXG5pbXBvcnQgeyBIaXN0b3J5TWFuYWdlciB9IGZyb20gJy4vSGlzdG9yeU1hbmFnZXInO1xyXG5pbXBvcnQgeyBjYWxjdWxhdGVSZXN1bHQgfSBmcm9tICcuL1Jlc3VsdENhbGN1bGF0b3InO1xyXG5pbXBvcnQgeyBCZXQsIFJvdW5kUmVjb3JkIH0gZnJvbSAnLi9tb2RlbHMnO1xyXG5cclxuZXhwb3J0IHR5cGUgR2FtZVN0YXRlID0gJ0lkbGUnIHwgJ0JldHRpbmcnIHwgJ1JvbGxpbmcnIHwgJ1Jlc3VsdCcgfCAnU2V0dGxlJztcclxuXHJcbmV4cG9ydCBjbGFzcyBSb3VuZE1hbmFnZXIge1xyXG4gIHN0YXRlOiBHYW1lU3RhdGUgPSAnSWRsZSc7XHJcbiAgY3VycmVudEJldDogQmV0IHwgbnVsbCA9IG51bGw7XHJcbiAgbGFzdERpY2U6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSB8IG51bGwgPSBudWxsO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgZGljZVNlcnZpY2U6IERpY2VTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBzY29yZU1hbmFnZXI6IFNjb3JlTWFuYWdlcixcclxuICAgIHByaXZhdGUgaGlzdG9yeTogSGlzdG9yeU1hbmFnZXIsXHJcbiAgICBwcml2YXRlIG9uU3RhdGVDaGFuZ2U/OiAoczogR2FtZVN0YXRlKSA9PiB2b2lkXHJcbiAgKSB7fVxyXG5cclxuICBwcml2YXRlIHNldFN0YXRlKHM6IEdhbWVTdGF0ZSkge1xyXG4gICAgdGhpcy5zdGF0ZSA9IHM7XHJcbiAgICBpZiAodGhpcy5vblN0YXRlQ2hhbmdlKSB0aGlzLm9uU3RhdGVDaGFuZ2Uocyk7XHJcbiAgfVxyXG5cclxuICAvLyBoZWxwZXIgxJHhu4MgeMOzYSBiZXQgKGFuIHRvw6BuKVxyXG4gIGNsZWFyQmV0KCkge1xyXG4gICAgdGhpcy5jdXJyZW50QmV0ID0gbnVsbDtcclxuICAgIC8vIGtoaSBjbGVhciwgdGEgY8OzIHRo4buDIGNodXnhu4NuIHbhu4EgSWRsZVxyXG4gICAgdGhpcy5zZXRTdGF0ZSgnSWRsZScpO1xyXG4gIH1cclxuXHJcbiAgc3RhcnRCZXR0aW5nKCkge1xyXG4gICAgdGhpcy5jbGVhckJldCgpO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSgnQmV0dGluZycpO1xyXG4gIH1cclxuXHJcbiAgcGxhY2VCZXQoYmV0OiBCZXQpIHtcclxuICAgIGlmIChiZXQuYW1vdW50IDw9IDApIHRocm93IG5ldyBFcnJvcignQmV0IG11c3QgPiAwJyk7XHJcbiAgICBpZiAoYmV0LmFtb3VudCA+IHRoaXMuc2NvcmVNYW5hZ2VyLmJhbGFuY2UpIHRocm93IG5ldyBFcnJvcignTm90IGVub3VnaCBiYWxhbmNlJyk7XHJcblxyXG4gICAgdGhpcy5jdXJyZW50QmV0ID0gYmV0O1xyXG4gICAgdGhpcy5zZXRTdGF0ZSgnQmV0dGluZycpO1xyXG4gIH1cclxuXHJcbiAgcm9sbCgpIHtcclxuICAgIGlmICghdGhpcy5jdXJyZW50QmV0KSB0aHJvdyBuZXcgRXJyb3IoJ05vIGJldCBwbGFjZWQhJyk7XHJcblxyXG4gICAgLy8gYsaw4bubYyAxOiBjaHV54buDbiBzYW5nIFJvbGxpbmdcclxuICAgIHRoaXMuc2V0U3RhdGUoJ1JvbGxpbmcnKTtcclxuXHJcbiAgICAvLyBixrDhu5tjIDI6IGdpZW8geMO6YyB44bqvY1xyXG4gICAgY29uc3QgZGljZSA9IHRoaXMuZGljZVNlcnZpY2Uucm9sbCgpO1xyXG4gICAgdGhpcy5sYXN0RGljZSA9IGRpY2U7XHJcblxyXG4gICAgLy8gYsaw4bubYyAzOiB0w61uaCBr4bq/dCBxdeG6o1xyXG4gICAgY29uc3QgY2FsYyA9IGNhbGN1bGF0ZVJlc3VsdChkaWNlLCB0aGlzLmN1cnJlbnRCZXQpO1xyXG5cclxuICAgIC8vIGLGsOG7m2MgNDogY2h1eeG7g24gc2FuZyBSZXN1bHQgKFVJIG7Dqm4gaGnhu4NuIHRo4buLIFdJTi9MT1NFIGzDumMgbsOgeSlcclxuICAgIHRoaXMuc2V0U3RhdGUoJ1Jlc3VsdCcpO1xyXG5cclxuICAgIC8vIGLGsOG7m2MgNTogY+G6rXAgbmjhuq10IMSRaeG7g21cclxuICAgIHRoaXMuc2NvcmVNYW5hZ2VyLmNoYW5nZShjYWxjLmRlbHRhKTtcclxuXHJcbiAgICAvLyBixrDhu5tjIDY6IHThuqFvIHJlY29yZCBs4buLY2ggc+G7rSBjaHXhuqluIChraeG7g3UgUm91bmRSZWNvcmQpXHJcbiAgICBjb25zdCByZWNvcmQ6IFJvdW5kUmVjb3JkID0ge1xyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgZGljZSxcclxuICAgICAgdG90YWw6IGNhbGMudG90YWwsXHJcbiAgICAgIGJldDogdGhpcy5jdXJyZW50QmV0LFxyXG4gICAgICByZXN1bHQ6IGNhbGMud2luID8gJ1dJTicgOiAnTE9TRScsXHJcbiAgICAgIGJhbGFuY2VBZnRlcjogdGhpcy5zY29yZU1hbmFnZXIuYmFsYW5jZSxcclxuICAgIH07XHJcblxyXG4gICAgLy8gYsaw4bubYyA3OiBsxrB1IHbDoG8gSGlzdG9yeU1hbmFnZXIgKGZvcm1hdCBoaXN0b3J5IFVJIGtow6FjLCBIaXN0b3J5TWFuYWdlciBjaOG7i3UpXHJcbiAgICB0aGlzLmhpc3RvcnkuYWRkKHtcclxuICAgICAgdGltZTogbmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKSxcclxuICAgICAgZGljZSxcclxuICAgICAgdG90YWw6IGNhbGMudG90YWwsXHJcbiAgICAgIGJldFR5cGU6IHRoaXMuY3VycmVudEJldC50eXBlLFxyXG4gICAgICByZXN1bHQ6IGNhbGMud2luID8gJ1dJTicgOiAnTE9TRScsXHJcbiAgICAgIGJhbGFuY2U6IHRoaXMuc2NvcmVNYW5hZ2VyLmJhbGFuY2UsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBixrDhu5tjIDg6IHNldHRsZSBob8OgbiB04bqldFxyXG4gICAgdGhpcy5zZXRTdGF0ZSgnU2V0dGxlJyk7XHJcblxyXG4gICAgLy8gcmVzZXQgYmV0IG5nYXkga2hpIHbDsm5nIGvhur90IHRow7pjIMSR4buDIHRyw6FuaCByZXVzZVxyXG4gICAgdGhpcy5jdXJyZW50QmV0ID0gbnVsbDtcclxuXHJcbiAgICAvLyB0cuG7nyB24buBIElkbGUgxJHhu4MgYuG6r3QgxJHhuqd1IHbDoW4gdGnhur9wIHRoZW9cclxuICAgIHRoaXMuc2V0U3RhdGUoJ0lkbGUnKTtcclxuXHJcbiAgICByZXR1cm4geyBkaWNlLCBjYWxjIH07XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBpbnRlcmZhY2UgU3RvcmFnZUxpa2Uge1xyXG4gIGdldEl0ZW0oa2V5OiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsO1xyXG4gIHNldEl0ZW0oa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiB2b2lkO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgU2NvcmVNYW5hZ2VyIHtcclxuICBwcml2YXRlIGtleTogc3RyaW5nO1xyXG4gIHByaXZhdGUgc3RvcmFnZTogU3RvcmFnZUxpa2U7XHJcbiAgYmFsYW5jZTogbnVtYmVyO1xyXG5cclxuICBjb25zdHJ1Y3RvcihzdG9yYWdlOiBTdG9yYWdlTGlrZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UsIGtleSA9ICdtaW5pLWRpY2UtYmFsYW5jZScpIHtcclxuICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XHJcbiAgICB0aGlzLmtleSA9IGtleTtcclxuXHJcbiAgICBjb25zdCByYXcgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmtleSk7XHJcblxyXG4gICAgLy8gY29udmVydCBzYWZlbHlcclxuICAgIGxldCB2YWwgPSByYXcgIT09IG51bGwgPyBOdW1iZXIocmF3KSA6IE5hTjtcclxuXHJcbiAgICAvLyBmYWxsYmFjayBu4bq/dSB2YWwgbMOgIE5hTiBob+G6t2MgPDBcclxuICAgIGlmIChpc05hTih2YWwpIHx8IHZhbCA8IDApIHtcclxuICAgICAgdGhpcy5iYWxhbmNlID0gMTAwMDsgLy8gxJFp4buDbSBt4bq3YyDEkeG7i25oIGtoaSBi4bqvdCDEkeG6p3VcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuYmFsYW5jZSA9IE1hdGguZmxvb3IodmFsKTsgLy8gxJHhuqNtIGLhuqNvIGzDoCBz4buRIG5ndXnDqm5cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnNhdmUoKTtcclxuICB9XHJcblxyXG4gIGNoYW5nZShkZWx0YTogbnVtYmVyKSB7XHJcbiAgICB0aGlzLmJhbGFuY2UgKz0gZGVsdGE7XHJcbiAgICBpZiAodGhpcy5iYWxhbmNlIDwgMCkgdGhpcy5iYWxhbmNlID0gMDtcclxuICAgIHRoaXMuc2F2ZSgpO1xyXG4gIH1cclxuXHJcbiAgc2F2ZSgpIHtcclxuICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKHRoaXMua2V5LCBTdHJpbmcodGhpcy5iYWxhbmNlKSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==